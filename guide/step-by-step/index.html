<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#3eaf7c"><link rel="icon" type="image/png" sizes="16x16" href="/images/ublog.png"><title>Step by Step Guide ðŸš€ | Î¼blog docs</title><meta name="description" content="a reference web application built with Django and Vue.js deployed on AWS with ECS Fargate"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.23">
    <link rel="preload" href="/django-step-by-step/assets/js/runtime~app.10395914.js" as="script"><link rel="preload" href="/django-step-by-step/assets/css/styles.592d94e4.css" as="style"><link rel="preload" href="/django-step-by-step/assets/js/981.12928b34.js" as="script"><link rel="preload" href="/django-step-by-step/assets/js/app.9807f846.js" as="script">
    <link rel="stylesheet" href="/django-step-by-step/assets/css/styles.592d94e4.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/django-step-by-step/" class=""><img class="logo" src="/django-step-by-step/images/ublog.png" alt="Î¼blog docs"><span class="site-name can-hide">Î¼blog docs</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/django-step-by-step/intro" class="nav-link" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Topics"><span class="title">Topics</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Topics"><span class="title">Topics</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/django-step-by-step/topics/django/" class="nav-link" aria-label="Django Application"><!--[--><!--]--> Django Application <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/nuxt/" class="nav-link" aria-label="Nuxt Application"><!--[--><!--]--> Nuxt Application <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/docker-compose/" class="nav-link" aria-label="Docker Compose"><!--[--><!--]--> Docker Compose <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/vuepress/" class="nav-link" aria-label="VuePress Documentation"><!--[--><!--]--> VuePress Documentation <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Guide"><span class="title">Guide</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Guide"><span class="title">Guide</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/django-step-by-step/guide/step-by-step/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="Step by step guide"><!--[--><!--]--> Step by step guide <!--[--><!--]--></a></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>CI/CD</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/guide/ci-cd/github-actions/" class="nav-link" aria-label="GitHub Actions"><!--[--><!--]--> GitHub Actions <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Deploy"><span class="title">Deploy</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Deploy"><span class="title">Deploy</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><a href="/django-step-by-step/deploy/aws" class="nav-link" aria-label="AWS ECS"><!--[--><!--]--> AWS ECS <!--[--><!--]--></a></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/terraform" class="nav-link" aria-label="Terraform"><!--[--><!--]--> Terraform <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/pulumi" class="nav-link" aria-label="Pulumi"><!--[--><!--]--> Pulumi <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/cdk" class="nav-link" aria-label="CDK"><!--[--><!--]--> CDK <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Application Updates</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/app" class="nav-link" aria-label="GitHub Action"><!--[--><!--]--> GitHub Action <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/django-step-by-step/guide/step-by-step/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/zh/" class="nav-link" aria-label="ç®€ä½“ä¸­æ–‡"><!--[--><!--]--> ç®€ä½“ä¸­æ–‡ <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/briancaffey/django-step-by-step" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/django-step-by-step/intro" class="nav-link" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Topics"><span class="title">Topics</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Topics"><span class="title">Topics</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/django-step-by-step/topics/django/" class="nav-link" aria-label="Django Application"><!--[--><!--]--> Django Application <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/nuxt/" class="nav-link" aria-label="Nuxt Application"><!--[--><!--]--> Nuxt Application <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/docker-compose/" class="nav-link" aria-label="Docker Compose"><!--[--><!--]--> Docker Compose <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/topics/vuepress/" class="nav-link" aria-label="VuePress Documentation"><!--[--><!--]--> VuePress Documentation <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Guide"><span class="title">Guide</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Guide"><span class="title">Guide</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/django-step-by-step/guide/step-by-step/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="Step by step guide"><!--[--><!--]--> Step by step guide <!--[--><!--]--></a></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>CI/CD</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/guide/ci-cd/github-actions/" class="nav-link" aria-label="GitHub Actions"><!--[--><!--]--> GitHub Actions <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Deploy"><span class="title">Deploy</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Deploy"><span class="title">Deploy</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><a href="/django-step-by-step/deploy/aws" class="nav-link" aria-label="AWS ECS"><!--[--><!--]--> AWS ECS <!--[--><!--]--></a></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/terraform" class="nav-link" aria-label="Terraform"><!--[--><!--]--> Terraform <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/pulumi" class="nav-link" aria-label="Pulumi"><!--[--><!--]--> Pulumi <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/aws/cdk" class="nav-link" aria-label="CDK"><!--[--><!--]--> CDK <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Application Updates</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/django-step-by-step/deploy/app" class="nav-link" aria-label="GitHub Action"><!--[--><!--]--> GitHub Action <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/django-step-by-step/guide/step-by-step/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/django-step-by-step/zh/" class="nav-link" aria-label="ç®€ä½“ä¸­æ–‡"><!--[--><!--]--> ç®€ä½“ä¸­æ–‡ <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/briancaffey/django-step-by-step" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Step by Step Guide ðŸš€</p><ul class=""><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#what-is-a-django-application" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="What is a Django application?"><!--[--><!--]--> What is a Django application? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#start-with-a-blank-git-repo-and-create-two-files-readme-md-and-step-by-step-md" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start with a blank git repo and create two files: README.md and STEP_BY_STEP.md:"><!--[--><!--]--> Start with a blank git repo and create two files: README.md and STEP_BY_STEP.md: <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-virtual-environment" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a virtual environment"><!--[--><!--]--> Create a virtual environment <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#activate-the-virtual-environment" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Activate the virtual environment"><!--[--><!--]--> Activate the virtual environment <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#make-sure-pip-is-upgraded-to-the-latest-version" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Make sure pip is upgraded to the latest version"><!--[--><!--]--> Make sure pip is upgraded to the latest version <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-django" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install Django"><!--[--><!--]--> Install Django <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#start-a-new-django-project" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start a new Django project"><!--[--><!--]--> Start a new Django project <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-gitignore-file-to-the-backend-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a .gitignore file to the backend directory"><!--[--><!--]--> Add a .gitignore file to the backend directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-gitignore-file-to-the-root-of-the-project" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a .gitignore file to the root of the project"><!--[--><!--]--> Add a .gitignore file to the root of the project <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#migrate-and-runserver" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="migrate and runserver"><!--[--><!--]--> migrate and runserver <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#settings-py-file-change-secret-key" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="settings.py file change: SECRET_KEY"><!--[--><!--]--> settings.py file change: SECRET_KEY <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#settings-py-file-change-debug" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="settings.py file change: DEBUG"><!--[--><!--]--> settings.py file change: DEBUG <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#move-backend-backend-settings-py-to-backend-backend-settings-base-py-and-add-backend-backend-settings-init-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Move backend/backend/settings.py to backend/backend/settings/base.py and add `backend/backend/settings/init.py"><!--[--><!--]--> Move backend/backend/settings.py to backend/backend/settings/base.py and add `backend/backend/settings/init.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#change-the-value-of-base-dir" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Change the value of BASE_DIR"><!--[--><!--]--> Change the value of BASE_DIR <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-backend-backend-settings-development-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create backend/backend/settings/development.py"><!--[--><!--]--> Create backend/backend/settings/development.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#change-django-settings-module-in-backend-manage-py-again" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Change DJANGO_SETTINGS_MODULE in backend/manage.py again"><!--[--><!--]--> Change DJANGO_SETTINGS_MODULE in backend/manage.py again <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-requirements-folder-with-three-files-base-txt-dev-txt-and-test-txt" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a requirements folder with three files: base.txt, dev.txt and test.txt"><!--[--><!--]--> Add a requirements folder with three files: base.txt, dev.txt and test.txt <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-django-debug-toolbar" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install Django Debug Toolbar"><!--[--><!--]--> Install Django Debug Toolbar <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-debug-toolbar-to-installed-apps" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add debug_toolbar to INSTALLED_APPS"><!--[--><!--]--> Add debug_toolbar to INSTALLED_APPS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-urlconf-for-debug-toolbar" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add URLconf for debug toolbar"><!--[--><!--]--> Add URLconf for debug toolbar <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-debug-toolbar-to-middleware" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add debug toolbar to middleware"><!--[--><!--]--> Add debug toolbar to middleware <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#set-internal-ips-for-debug-toolbar" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Set INTERNAL_IPS for debug toolbar"><!--[--><!--]--> Set INTERNAL_IPS for debug toolbar <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-superuser-with-createsuperuser" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a superuser with createsuperuser"><!--[--><!--]--> Create a superuser with createsuperuser <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#rename-the-admin-url-optional" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Rename the /admin URL (Optional)"><!--[--><!--]--> Rename the /admin URL (Optional) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-django-app-called-core" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a Django app called core"><!--[--><!--]--> Setup a Django app called core <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-django-app-called-accounts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a Django app called accounts"><!--[--><!--]--> Setup a Django app called accounts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-custom-user-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a Custom User Model"><!--[--><!--]--> Setup a Custom User Model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#set-auth-user-model-accounts-customuser-in-base-py-settings" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Set AUTH_USER_MODEL = &#39;accounts.CustomUser&#39; in base.py settings"><!--[--><!--]--> Set AUTH_USER_MODEL = &#39;accounts.CustomUser&#39; in base.py settings <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-customusermanager-for-customuser-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CustomUserManager for CustomUser model"><!--[--><!--]--> Add CustomUserManager for CustomUser model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-forms-for-customuser-admin" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add forms for CustomUser admin"><!--[--><!--]--> Add forms for CustomUser admin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-customuser-admin" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CustomUser admin"><!--[--><!--]--> Add CustomUser admin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-tests-for-the-customuser-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add tests for the CustomUser model"><!--[--><!--]--> Add tests for the CustomUser model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-makemigrations-and-migrate-management-command" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run makemigrations and migrate management command"><!--[--><!--]--> Run makemigrations and migrate management command <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-the-tests" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run the tests"><!--[--><!--]--> Run the tests <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-pytest" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install pytest"><!--[--><!--]--> Install pytest <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-pytest-ini-to-configure-pytest" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add pytest.ini to configure pytest"><!--[--><!--]--> Add pytest.ini to configure pytest <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-pytest-command-to-makefile" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add pytest command to Makefile"><!--[--><!--]--> Add pytest command to Makefile <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-code-coverage-reports" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup code coverage reports"><!--[--><!--]--> Setup code coverage reports <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#write-browsable-coverage-to-a-directory-and-view-with-simple-http-server" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Write browsable coverage to a directory and view with simple HTTP server"><!--[--><!--]--> Write browsable coverage to a directory and view with simple HTTP server <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-coveragerc-to-exclude-files-from-coverage-report" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add .coveragerc to exclude files from coverage report"><!--[--><!--]--> Add .coveragerc to exclude files from coverage report <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#configure-vscode-settings" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configure VSCode settings"><!--[--><!--]--> Configure VSCode settings <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#python-code-linting-with-flake8" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Python code linting with flake8"><!--[--><!--]--> Python code linting with flake8 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#format-python-code-with-black" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Format python code with black"><!--[--><!--]--> Format python code with black <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-runserver-plus-and-werkzeug" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add runserver_plus and Werkzeug"><!--[--><!--]--> Add runserver_plus and Werkzeug <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-base-model-for-tracking-created-modified-timestamps" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a base model for tracking created/modified timestamps"><!--[--><!--]--> Add a base model for tracking created/modified timestamps <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-settings-for-enabling-use-of-jupyter-notebooks" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add settings for enabling use of Jupyter notebooks"><!--[--><!--]--> Add settings for enabling use of Jupyter notebooks <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-postgres-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup Postgres locally"><!--[--><!--]--> Setup Postgres locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#configure-our-django-application-to-use-our-local-postgres-service" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configure our Django application to use our local postgres service"><!--[--><!--]--> Configure our Django application to use our local postgres service <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#another-approach-to-running-postgres-on-our-machine-and-an-introduction-to-docker-run-postgres-in-a-docker-container" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Another approach to running postgres on our machine and an introduction to docker: run postgres in a docker container"><!--[--><!--]--> Another approach to running postgres on our machine and an introduction to docker: run postgres in a docker container <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#improve-the-readability-of-the-command-by-using-docker-compose" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Improve the readability of the command by using docker-compose"><!--[--><!--]--> Improve the readability of the command by using docker-compose <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-pgadmin4-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup pgadmin4 locally"><!--[--><!--]--> Setup pgadmin4 locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-pgadmin4-in-docker-compose" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup pgadmin4 in docker-compose"><!--[--><!--]--> Setup pgadmin4 in docker-compose <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-dockerfile-for-our-django-application" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a Dockerfile for our Django application"><!--[--><!--]--> Add a Dockerfile for our Django application <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-redis-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup redis locally"><!--[--><!--]--> Setup redis locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-redis-to-docker-compose-file-for-celery-broker" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add redis to docker-compose file for celery broker"><!--[--><!--]--> Add redis to docker-compose file for celery broker <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-redis-commander-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup redis-commander locally"><!--[--><!--]--> Setup redis-commander locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-requestlog-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a RequestLog model"><!--[--><!--]--> Add a RequestLog model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-middleware-to-handle-requestlog-creation" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a middleware to handle RequestLog creation"><!--[--><!--]--> Add a middleware to handle RequestLog creation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-an-admin-view-for-the-requestlog" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add an admin view for the RequestLog"><!--[--><!--]--> Add an admin view for the RequestLog <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-celery-app" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup Celery app"><!--[--><!--]--> Setup Celery app <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-celery-app-py-to-backend-backend" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add celery_app.py to backend/backend"><!--[--><!--]--> Add celery_app.py to backend/backend <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-celery-in-backend-backend-init-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install celery in backend/backend/__init__.py"><!--[--><!--]--> Install celery in backend/backend/__init__.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-celery-settings-to-django-settings" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add celery settings to Django settings"><!--[--><!--]--> Add celery settings to Django settings <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-debug-celery-task" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a debug celery task"><!--[--><!--]--> Add a debug celery task <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-the-celery-command-to-start-a-worker" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run the celery command to start a worker"><!--[--><!--]--> Run the celery command to start a worker <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-the-debug-task" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run the debug task"><!--[--><!--]--> Run the debug task <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-watchdog-command-for-celery" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup watchdog command for celery"><!--[--><!--]--> Setup watchdog command for celery <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-flower-for-celery-monitoring" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup flower for celery monitoring"><!--[--><!--]--> Setup flower for celery monitoring <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#decide-if-you-need-celery-tasks-always-eager-to-be-set-to-true" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Decide if you need CELERY_TASKS_ALWAYS_EAGER to be set to True"><!--[--><!--]--> Decide if you need CELERY_TASKS_ALWAYS_EAGER to be set to True <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-celery-beat-settings-periodics-tasks" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup celery beat, settings, periodics tasks"><!--[--><!--]--> Setup celery beat, settings, periodics tasks <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-the-celery-beat-process" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run the celery beat process"><!--[--><!--]--> Run the celery beat process <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-mailhog-for-testing-email-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup mailhog for testing email locally"><!--[--><!--]--> Setup mailhog for testing email locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#build-a-model-that-we-can-use-to-demonstrate-crud-and-other-concepts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Build a Model that we can use to demonstrate CRUD and other concepts"><!--[--><!--]--> Build a Model that we can use to demonstrate CRUD and other concepts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-new-django-app-for-our-microblogging-demo-application" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a new Django app for our microblogging demo application"><!--[--><!--]--> Create a new Django app for our microblogging demo application <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-the-model-for-our-microblogs-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add the model for our microblogs posts"><!--[--><!--]--> Add the model for our microblogs posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-makemigrations" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run makemigrations"><!--[--><!--]--> Run makemigrations <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-the-migrate-command" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run the migrate command"><!--[--><!--]--> Run the migrate command <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#register-the-post-model-to-the-django-admin" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Register the Post model to the Django admin"><!--[--><!--]--> Register the Post model to the Django admin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-str-method-to-our-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a __str__ method to our model"><!--[--><!--]--> Add a __str__ method to our model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-model-factories-for-micro-blog-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add model factories for micro blog post"><!--[--><!--]--> Add model factories for micro blog post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-factory-py-file-in-the-blog-app-with-a-postfactory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a factory.py file in the blog app with a PostFactory"><!--[--><!--]--> Setup a factory.py file in the blog app with a PostFactory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-simple-test-using-postfactory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a simple test using PostFactory"><!--[--><!--]--> Create a simple test using PostFactory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-url-pattern-that-will-list-all-of-the-blog-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a URL pattern that will list all of the blog posts"><!--[--><!--]--> Create a URL pattern that will list all of the blog posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#include-the-urls-you-just-created-in-the-main-urls-file" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Include the URLs you just created in the main URLs file"><!--[--><!--]--> Include the URLs you just created in the main URLs file <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-simple-function-based-view-for-viewing-all-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a simple function-based view for viewing all posts"><!--[--><!--]--> Create a simple function-based view for viewing all posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-templates-directory-in-the-blog-app-and-add-posts-html" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a templates directory in the blog app and add posts.html"><!--[--><!--]--> Create a templates directory in the blog app and add posts.html <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-dirs-base-dir-templates-to-settings-base-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add &quot;DIRS&quot;: [BASE_DIR / &quot;templates&quot;], to settings/base.py"><!--[--><!--]--> Add &quot;DIRS&quot;: [BASE_DIR / &quot;templates&quot;], to settings/base.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-new-folder-in-the-backend-directory-called-templates-and-add-base-html" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a new folder in the backend directory called templates and add base.html"><!--[--><!--]--> Add a new folder in the backend directory called templates and add base.html <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-bootstrap-to-our-base-template" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Bootstrap to our base template"><!--[--><!--]--> Add Bootstrap to our base template <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#write-a-management-command-that-generates-fake-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Write a management command that generates fake data"><!--[--><!--]--> Write a management command that generates fake data <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-pagination-to-posts-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add pagination to posts view"><!--[--><!--]--> Add pagination to posts view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-post-detail-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a post detail view"><!--[--><!--]--> Create a post detail view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-url-for-post-detail-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add URL for post detail view"><!--[--><!--]--> Add URL for post detail view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-template-called-post-html-in-templates" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a template called post.html in templates"><!--[--><!--]--> Create a template called post.html in templates <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#link-to-detail-views-from-the-list-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Link to detail views from the list view"><!--[--><!--]--> Link to detail views from the list view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#set-up-head-for-post-detail-page-for-seo" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Set up head for Post detail page for SEO"><!--[--><!--]--> Set up head for Post detail page for SEO <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-post-create-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Post Create Form"><!--[--><!--]--> Add Post Create Form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-url-for-a-creating-a-new-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a URL for a creating a new post"><!--[--><!--]--> Add a URL for a creating a new post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-new-post-html-template" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add new_post.html template"><!--[--><!--]--> Add new_post.html template <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#change-the-ordering-of-posts-in-the-post-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Change the ordering of posts in the Post model"><!--[--><!--]--> Change the ordering of posts in the Post model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-wildcard-to-allowed-hosts-in-development-settings-module" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add wildcard to ALLOWED_HOSTS in development settings module"><!--[--><!--]--> Add wildcard to ALLOWED_HOSTS in development settings module <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#use-django-messaging-framework-to-update-user-on-post-creation-success" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Use Django messaging framework to update user on post creation success"><!--[--><!--]--> Use Django messaging framework to update user on post creation success <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-urls-py-in-the-accounts-app-with-a-login-path" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create urls.py in the accounts app with a login path"><!--[--><!--]--> Create urls.py in the accounts app with a login path <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-the-login-view-in-apps-accounts-views" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create the login view in apps/accounts/views"><!--[--><!--]--> Create the login view in apps/accounts/views <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#override-the-default-login-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Override the Default Login form"><!--[--><!--]--> Override the Default Login form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#set-login-redirect-url-and-login-redirect-url-in-base-settings-module" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Set LOGIN_REDIRECT_URL and LOGIN_REDIRECT_URL in base settings module"><!--[--><!--]--> Set LOGIN_REDIRECT_URL and LOGIN_REDIRECT_URL in base settings module <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-login-page" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create Login page"><!--[--><!--]--> Create Login page <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#enable-logout" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Enable logout"><!--[--><!--]--> Enable logout <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-update-view-for-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create update view for post"><!--[--><!--]--> Create update view for post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-update-url-for-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create update URL for post"><!--[--><!--]--> Create update URL for post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-delete-url-path-for-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add delete URL path for posts"><!--[--><!--]--> Add delete URL path for posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-delete-view-for-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create delete view for post"><!--[--><!--]--> Create delete view for post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#enable-searching-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Enable searching posts"><!--[--><!--]--> Enable searching posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#fix-pagination-with-search-term" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Fix pagination with search term"><!--[--><!--]--> Fix pagination with search term <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-registration-url" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add registration URL"><!--[--><!--]--> Add registration URL <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-registration-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add registration view"><!--[--><!--]--> Add registration view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-registration-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add registration form"><!--[--><!--]--> Add registration form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-email-confirmation-url-and-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add email confirmation url and view"><!--[--><!--]--> Add email confirmation url and view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-request-password-reset-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add request Password reset form"><!--[--><!--]--> Add request Password reset form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-password-reset-email-with-link" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add password reset email with link"><!--[--><!--]--> Add password reset email with link <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-password-reset-url" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add password reset URL"><!--[--><!--]--> Add password reset URL <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-password-reset-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add password reset form"><!--[--><!--]--> Add password reset form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-password-reset-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add password reset view"><!--[--><!--]--> Add password reset view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-vue-via-cdn-in-base-html" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Vue via CDN in base.html"><!--[--><!--]--> Add Vue via CDN in base.html <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-an-example-of-how-to-setup-a-vue-component-in-django-template" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add an example of how to setup a Vue component in Django template"><!--[--><!--]--> Add an example of how to setup a Vue component in Django template <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-template-called-post-likes-html" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a template called post_likes.html"><!--[--><!--]--> Create a template called post_likes.html <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-vue-component-definition-and-template" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Vue component definition and template"><!--[--><!--]--> Add Vue component definition and template <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-axios-via-cdn" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add axios Via CDN"><!--[--><!--]--> Add axios Via CDN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#configure-axios-cdn" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configure Axios CDN"><!--[--><!--]--> Configure Axios CDN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-method-to-the-postlike-component-that-will-make-an-api-call-using-axios" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a method to the PostLike component that will make an API call using axios"><!--[--><!--]--> Add a method to the PostLike component that will make an API call using axios <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-an-endpoint-that-will-handle-our-axios-call" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup an endpoint that will handle our axios call"><!--[--><!--]--> Setup an endpoint that will handle our axios call <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-view-to-handle-the-like-post-endpoint-that-returns-a-jsonresponse" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a view to handle the like-post endpoint that returns a JsonResponse"><!--[--><!--]--> Setup a view to handle the like-post endpoint that returns a JsonResponse <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#implement-through-model-for-manytomany-field-for-post-likes" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Implement through Model for ManyToMany field for Post likes"><!--[--><!--]--> Implement through Model for ManyToMany field for Post likes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-through-model-to-django-admin" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add through model to Django admin"><!--[--><!--]--> Add through model to Django admin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-makemigrations-and-migrate-for-postlike" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run makemigrations and migrate for PostLike"><!--[--><!--]--> Run makemigrations and migrate for PostLike <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-prefetch-related-created-by-to-post-list-query-to-reduce-db-queries" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add prefetch_related(&quot;created_by&quot;) to post list query to reduce DB queries"><!--[--><!--]--> Add prefetch_related(&quot;created_by&quot;) to post list query to reduce DB queries <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-favicon-in-static" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a favicon in static"><!--[--><!--]--> Add a favicon in static <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-github-workflows-lint-yml-for-github-action-that-lints-python-code" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add .github/workflows/lint.yml for GitHub Action that lints Python code"><!--[--><!--]--> Add .github/workflows/lint.yml for GitHub Action that lints Python code <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-bitbucket-pipelines-yml-for-bitbucket-pipelines" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add bitbucket-pipelines.yml for BitBucket pipelines"><!--[--><!--]--> Add bitbucket-pipelines.yml for BitBucket pipelines <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#generic-class-based-views" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Generic Class Based Views"><!--[--><!--]--> Generic Class Based Views <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-file-in-the-blog-app-called-class-based-views-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a file in the blog app called class_based_views.py"><!--[--><!--]--> Create a file in the blog app called class_based_views.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-generic-listview-to-the-class-based-views-file" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a generic ListView to the class_based_views file"><!--[--><!--]--> Add a generic ListView to the class_based_views file <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-a-new-urls-file" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup a new URLs file"><!--[--><!--]--> Setup a new URLs file <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-urlpatterns-with-a-path-that-uses-the-postlist-cbv" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a urlpatterns with a path that uses the PostList CBV"><!--[--><!--]--> Add a urlpatterns with a path that uses the PostList CBV <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#include-cbv-urls-py-in-backend-urls-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Include cbv_urls.py in backend/urls.py"><!--[--><!--]--> Include cbv_urls.py in backend/urls.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#fix-the-template-for-the-postlist-cbv" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Fix the template for the PostList CBV"><!--[--><!--]--> Fix the template for the PostList CBV <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-cbv-detailview-for-viewing-a-single-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CBV DetailView for viewing a single post"><!--[--><!--]--> Add CBV DetailView for viewing a single post <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-url-path-for-detailview" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add URL path for DetailView"><!--[--><!--]--> Add URL path for DetailView <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-template-for-the-postdetailview-in-blog-post-detail-in-the-blog-app-templates-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a template for the PostDetailView in blog/post_detail in the blog app templates directory"><!--[--><!--]--> Add a template for the PostDetailView in blog/post_detail in the blog app templates directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-postcreateview-for-creating-posts-using-cbv" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a PostCreateView for creating posts using CBV"><!--[--><!--]--> Add a PostCreateView for creating posts using CBV <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-postupdateview-for-editing-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a PostUpdateView for editing posts"><!--[--><!--]--> Add a PostUpdateView for editing posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-deletepostview-for-deleting-posts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a DeletePostView for deleting posts"><!--[--><!--]--> Add a DeletePostView for deleting posts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-tests-for-cbvs" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add tests for CBVs"><!--[--><!--]--> Add tests for CBVs <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#account-management" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Account Management"><!--[--><!--]--> Account Management <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-profile-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add profile view"><!--[--><!--]--> Add profile view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-account-settings-view" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add account settings view"><!--[--><!--]--> Add account settings view <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#refactor-queryset-and-manager-for-post-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Refactor QuerySet and Manager for Post model"><!--[--><!--]--> Refactor QuerySet and Manager for Post model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#account-settings" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Account settings"><!--[--><!--]--> Account settings <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#django-rest-framework" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Django REST Framework"><!--[--><!--]--> Django REST Framework <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-django-rest-framework-to-base-txt-dependencies" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Django REST Framework to base.txt dependencies"><!--[--><!--]--> Add Django REST Framework to base.txt dependencies <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-restframework-to-installed-apps-in-base-settings-module" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add restframework to INSTALLED_APPS in base settings module"><!--[--><!--]--> Add restframework to INSTALLED_APPS in base settings module <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-rest-framework-urls-under-the-if-settings-debug-block-in-backend-urls-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add REST Framework URLs under the if settings.DEBUG block in backend/urls.py"><!--[--><!--]--> Add REST Framework URLs under the if settings.DEBUG block in backend/urls.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-openapi-swaggerui-url-path-in-backend-urls-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add OpenAPI/SwaggerUI URL path in backend/urls.py"><!--[--><!--]--> Add OpenAPI/SwaggerUI URL path in backend/urls.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-the-following-file-to-the-top-level-templates-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add the following file to the top-level templates directory"><!--[--><!--]--> Add the following file to the top-level templates directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-dependencies-for-openapi-to-base-txt" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add dependencies for OpenAPI to base.txt"><!--[--><!--]--> Add dependencies for OpenAPI to base.txt <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-a-directory-for-the-openapi-schema" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create a directory for the OpenAPI Schema"><!--[--><!--]--> Create a directory for the OpenAPI Schema <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#generate-the-openapi-schema" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Generate the OpenAPI schema"><!--[--><!--]--> Generate the OpenAPI schema <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-postserializer-in-serializers-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add PostSerializer in serializers.py"><!--[--><!--]--> Add PostSerializer in serializers.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-crud-drf-fbvs-for-blog-app" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CRUD DRF FBVs for blog app"><!--[--><!--]--> Add CRUD DRF FBVs for blog app <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-crud-drf-cbvs-for-blog-app" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CRUD DRF CBVs for blog app"><!--[--><!--]--> Add CRUD DRF CBVs for blog app <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-crud-gcbvs-for-blog-app" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CRUD GCBVs for blog app??"><!--[--><!--]--> Add CRUD GCBVs for blog app?? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#graphql-setup-tasks" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="GraphQL Setup Tasks"><!--[--><!--]--> GraphQL Setup Tasks <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#todo-replace-exceptions-with-graphqlexceptions" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="TODO: replace Exceptions with GraphqlExceptions"><!--[--><!--]--> TODO: replace Exceptions with GraphqlExceptions <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#graphql-resources" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="GraphQL Resources"><!--[--><!--]--> GraphQL Resources <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-graphql-dependencies" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add GraphQL dependencies"><!--[--><!--]--> Add GraphQL dependencies <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-graphene-django-to-installed-apps" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add graphene_django to INSTALLED_APPS"><!--[--><!--]--> Add graphene_django to INSTALLED_APPS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-graphene-settings-to-base-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add GRAPHENE settings to base.py"><!--[--><!--]--> Add GRAPHENE settings to base.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-schema-py-in-the-blog-app-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add schema.py in the blog app directory"><!--[--><!--]--> Add schema.py in the blog app directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-schema-py-to-the-backend-backend-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a schema.py to the backend/backend directory"><!--[--><!--]--> Add a schema.py to the backend/backend directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-graphql-endpoint-to-backend-urls-py" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a GraphQL endpoint to backend/urls.py"><!--[--><!--]--> Add a GraphQL endpoint to backend/urls.py <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-cypress-dependencies" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Cypress Dependencies"><!--[--><!--]--> Add Cypress Dependencies <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#start-cypress" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start Cypress"><!--[--><!--]--> Start Cypress <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#use-npm-to-open-cypress" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Use npm to open Cypress"><!--[--><!--]--> Use npm to open Cypress <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#using-on-wsl-2" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Using on WSL 2"><!--[--><!--]--> Using on WSL 2 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#frontend-clients" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Frontend clients"><!--[--><!--]--> Frontend clients <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-vue-as-standalone-spa-show-how-api-calls-will-not-work-without-cors" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Vue as standalone SPA (show how API calls will not work without CORS)"><!--[--><!--]--> Add Vue as standalone SPA (show how API calls will not work without CORS) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-cors" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add CORS"><!--[--><!--]--> Add CORS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-nginx-and-remove-cors" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add NGINX and remove CORS"><!--[--><!--]--> Add NGINX and remove CORS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-nginx-dockerfile-for-local-development" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add NGINX Dockerfile for local development"><!--[--><!--]--> Add NGINX Dockerfile for local development <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-django-channels-settings-routers-consumers-async-tests" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup Django Channels (settings, routers, consumers, async tests)"><!--[--><!--]--> Setup Django Channels (settings, routers, consumers, async tests) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-git-hooks-in-docker-compose" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup git hooks in docker-compose"><!--[--><!--]--> Setup git hooks in docker-compose <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#setup-vue-in-nginx-web-sockets-for-hot-reloading-index-html-etc" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setup Vue in NGINX (web-sockets for hot reloading, index.html, etc)"><!--[--><!--]--> Setup Vue in NGINX (web-sockets for hot reloading, index.html, etc) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-session-authentication-for-vue-spa" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add Session Authentication for Vue SPA"><!--[--><!--]--> Add Session Authentication for Vue SPA <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#show-how-to-setup-e2e-tests-with-cypress" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Show how to setup e2e tests with Cypress"><!--[--><!--]--> Show how to setup e2e tests with Cypress <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#draw-a-project-diagram-using-diagrams-net" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Draw a project diagram using diagrams.net"><!--[--><!--]--> Draw a project diagram using diagrams.net <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#generate-model-visualizations-with-graphviz" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Generate model visualizations with graphviz"><!--[--><!--]--> Generate model visualizations with graphviz <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#vscode-remote-container" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="VSCode remote container"><!--[--><!--]--> VSCode remote container <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-privacy-policy" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a privacy policy"><!--[--><!--]--> Add a privacy policy <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#cookie-consent-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Cookie consent form"><!--[--><!--]--> Cookie consent form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-constants-file" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a constants file"><!--[--><!--]--> Add a constants file <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-poetry" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install poetry"><!--[--><!--]--> Install poetry <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#run-poetry-init-to-setup-pyproject-toml" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Run poetry init to setup pyproject.toml"><!--[--><!--]--> Run poetry init to setup pyproject.toml <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-project-dependencies-using-semver-notation" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add project dependencies using SemVer notation"><!--[--><!--]--> Add project dependencies using SemVer notation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-make-command-to-export-requirements-txt-and-requirements-dev-txt-from-poetry" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add make command to export requirements.txt and requirements_dev.txt from poetry"><!--[--><!--]--> Add make command to export requirements.txt and requirements_dev.txt from poetry <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-new-python-dependencies-with-poetry-add" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add new python dependencies with poetry add"><!--[--><!--]--> Add new python dependencies with poetry add <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#configure-vscode-to-use-poetry-environment" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configure VSCode to use Poetry environment"><!--[--><!--]--> Configure VSCode to use Poetry environment <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#microk8s-setup" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="microk8s setup"><!--[--><!--]--> microk8s setup <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-cdk8s-cli" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install cdk8s-cli"><!--[--><!--]--> Install cdk8s-cli <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#start-a-cdk8s-project-in-the-k8s-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start a cdk8s project in the k8s directory"><!--[--><!--]--> Start a cdk8s project in the k8s directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#wsl" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="WSL"><!--[--><!--]--> WSL <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#update-kubectl" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Update kubectl"><!--[--><!--]--> Update kubectl <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#doctl" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="doctl"><!--[--><!--]--> doctl <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#cdk" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="CDK"><!--[--><!--]--> CDK <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#about-cdk" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="About CDK"><!--[--><!--]--> About CDK <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-cdk" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install CDK"><!--[--><!--]--> Install CDK <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#start-the-cdk-project" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start the CDK project"><!--[--><!--]--> Start the CDK project <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-django-cdk" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install django-cdk"><!--[--><!--]--> Install django-cdk <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#npm-run-watch" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="npm run watch"><!--[--><!--]--> npm run watch <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#synthesize-the-stack" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Synthesize the stack"><!--[--><!--]--> Synthesize the stack <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-image-to-blog-post" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add image to blog post"><!--[--><!--]--> Add image to blog post <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-dependencies" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install dependencies"><!--[--><!--]--> Install dependencies <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-image-field-to-post-model" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add image field to Post model"><!--[--><!--]--> Add image field to Post model <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#make-and-run-migrations" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Make and run migrations"><!--[--><!--]--> Make and run migrations <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#create-backend-media-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create backend media directory"><!--[--><!--]--> Create backend media directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-gitignore-to-media-directory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add .gitignore to media directory"><!--[--><!--]--> Add .gitignore to media directory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-url-patterns-for-serving-media-locally" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add URL patterns for serving media locally"><!--[--><!--]--> Add URL patterns for serving media locally <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-image-to-django-template" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add image to Django template"><!--[--><!--]--> Add image to Django template <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-styling-to-the-image" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add styling to the image"><!--[--><!--]--> Add styling to the image <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-image-upload-button-for-html-form" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add image upload button for HTML form"><!--[--><!--]--> Add image upload button for HTML form <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#update-postform" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Update PostForm"><!--[--><!--]--> Update PostForm <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-image-url-to-postserializer" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add image URL to PostSerializer"><!--[--><!--]--> Add image URL to PostSerializer <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-images-for-test" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add images for test"><!--[--><!--]--> Add images for test <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-a-field-to-the-post-model-factory" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add a field to the Post Model Factory"><!--[--><!--]--> Add a field to the Post Model Factory <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-cypress-file-upload" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add cypress-file-upload"><!--[--><!--]--> Add cypress-file-upload <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#install-graphene-extension-for-image-support-in-graphql" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install Graphene extension for image support in GraphQL"><!--[--><!--]--> Install Graphene extension for image support in GraphQL <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#add-images-to-test-case-logic" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Add images to test case logic"><!--[--><!--]--> Add images to test case logic <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#graphql-together-with-or-replacing-drf-rest" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="GraphQL (together with or replacing DRF/REST)"><!--[--><!--]--> GraphQL (together with or replacing DRF/REST) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#spatial-and-geographic-databases-postgis" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Spatial and Geographic Databases (PostGIS)"><!--[--><!--]--> Spatial and Geographic Databases (PostGIS) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#portainer-ui-for-viewing-containers-and-logs" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Portainer UI for viewing containers and logs"><!--[--><!--]--> Portainer UI for viewing containers and logs <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/django-step-by-step/guide/step-by-step/#wagtail-for-managing-blog-content" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Wagtail for managing blog content"><!--[--><!--]--> Wagtail for managing blog content <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="step-by-step-guide" tabindex="-1"><a class="header-anchor" href="#step-by-step-guide" aria-hidden="true">#</a> Step by Step Guide ðŸš€</h1><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>This section is mostly outdated and needs to be removed or re-written. Some of the content might be helpful for someone setting up a new Django project, but it doesn&#39;t reflect the most recent changes in the <code>django-step-by-step</code> repo.</p></div><p>This document covers Django project setup step by step at a high level of detail. Starting from a blank directory, this guide will progressively build an application in a local development environment that uses Django as the core service. In addition to Django, there is a demonstration on how to use Vue.js along with Django in a &quot;progressive&quot; fashion. Vue is a personal choice, but it can be easily exchanged with any other frontend library or framework.</p><h2 id="what-is-a-django-application" tabindex="-1"><a class="header-anchor" href="#what-is-a-django-application" aria-hidden="true">#</a> What is a Django application?</h2><p>Django application is an ambiguous term. There are three possible meanings that come to mind when someone says &quot;Django application&quot;:</p><ol><li>A web application built using the Django Web framework. Examples include YouTube, Pinterest, reddit, etc.</li><li>A reusable &quot;plugin&quot; that can installed in another Django application that a developer is creating.</li><li>A logical grouping of code in a Django application (these are typically called <code>apps</code>, and are created with the management command <code>startapp</code>)</li></ol><p>This guide will focus on the first definition of &quot;Django application&quot;. The application logic and data model will be very simple so that the guide can focus on showing how to build a productive Django development environment.</p><p>There are tools that generate Django projects with complete development environments, <a href="https://github.com/pydanny/cookiecutter-django" target="_blank" rel="noopener noreferrer">cookiecutter-django<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> is a popular example. This guide is focusing on the order of each step and explaining how and why certain architectural decisions are made. This project will not provide a &quot;production ready&quot; template, but it will be developed in a way that will support multiple deployment scenarios such as containers and functions (such as AWS Lambda). This guide will cover continuous integration (automated acceptance testing)</p><p>Again, the goal of this project is to walk the reader through each step of setting up a Django project from scratch. Some of the topics include:</p><ul><li>How to setup your development environment on Windows (WSL 2) and Linux environment</li><li>Popular tools used to help build Django applications (testing, debugging, etc.)</li><li>Authentication and social authentication</li><li>Different ways to incorporate Vue.js and which one you should choose for your next project if you intend on using Vue.</li><li>How docker can be used in a Django application development workflow and reasons you might want to use docker</li></ul><p>Writing this is not easy. There are lots of decisions to make regarding what to explain and selecting which combination of competing technologies to use.</p><h2 id="start-with-a-blank-git-repo-and-create-two-files-readme-md-and-step-by-step-md" tabindex="-1"><a class="header-anchor" href="#start-with-a-blank-git-repo-and-create-two-files-readme-md-and-step-by-step-md" aria-hidden="true">#</a> Start with a blank git repo and create two files: <code>README.md</code> and <code>STEP_BY_STEP.md</code>:</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>touch README.md STEP_BY_STEP.md
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><code>README.md</code> will be a brief introduction to the project followed by simple instructions for setting up the project locally. <code>STEP_BY_STEP.md</code> will include our step-by-step instructions for building this project.</p><p>This file will document our project setup, step by step.</p><h2 id="create-a-virtual-environment" tabindex="-1"><a class="header-anchor" href="#create-a-virtual-environment" aria-hidden="true">#</a> Create a virtual environment</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>python3 -m venv .local-env
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="activate-the-virtual-environment" tabindex="-1"><a class="header-anchor" href="#activate-the-virtual-environment" aria-hidden="true">#</a> Activate the virtual environment</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>source .local-env/bin/activate
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="make-sure-pip-is-upgraded-to-the-latest-version" tabindex="-1"><a class="header-anchor" href="#make-sure-pip-is-upgraded-to-the-latest-version" aria-hidden="true">#</a> Make sure pip is upgraded to the latest version</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>python3 -m pip install --upgrade pip
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="install-django" tabindex="-1"><a class="header-anchor" href="#install-django" aria-hidden="true">#</a> Install Django</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pip install Django==3.1.5
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Install the latest version of Django. You may also want to install the LTS version. See https://www.djangoproject.com/download/ for more information about Django&#39;s long term support releases.</p><h2 id="start-a-new-django-project" tabindex="-1"><a class="header-anchor" href="#start-a-new-django-project" aria-hidden="true">#</a> Start a new Django project</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django-admin startproject backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This creates a project with the following structure:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ tree -L 2 backend

backend
â”œâ”€â”€ backend
â”‚   â”œâ”€â”€ asgi.py
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ __pycache__
â”‚   â”œâ”€â”€ settings.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€ db.sqlite3
â””â”€â”€ manage.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Note that there are two &quot;backend&quot; folders. I&#39;ll refer to these as either <code>backend/</code> or <code>backend/backend/</code> for the nested <code>backend</code> folder that contains <code>settings.py</code></p><h2 id="add-a-gitignore-file-to-the-backend-directory" tabindex="-1"><a class="header-anchor" href="#add-a-gitignore-file-to-the-backend-directory" aria-hidden="true">#</a> Add a <code>.gitignore</code> file to the <code>backend</code> directory</h2><p>Here&#39;s a good <code>.gitignore</code> file for Python/Django applications:</p><p><a href="https://www.toptal.com/developers/gitignore/api/python,django" target="_blank" rel="noopener noreferrer">https://www.toptal.com/developers/gitignore/api/python,django<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>wget -O backend/.gitignore https://www.toptal.com/developers/gitignore/api/python,django
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-gitignore-file-to-the-root-of-the-project" tabindex="-1"><a class="header-anchor" href="#add-a-gitignore-file-to-the-root-of-the-project" aria-hidden="true">#</a> Add a <code>.gitignore</code> file to the root of the project</h2><p>Add another `.gitignore file, but this time to the root of the project:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;.env&quot; &gt; .gitignore
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="migrate-and-runserver" tabindex="-1"><a class="header-anchor" href="#migrate-and-runserver" aria-hidden="true">#</a> migrate and runserver</h2><p>Let&#39;s start our Django project to make sure that everything is working properly:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>./backend/manage.py migrate &amp;&amp; ./backend/manage.py runserver
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>./backend/manage.py migrate &amp;&amp; ./backend/manage.py runserver
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying auth.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying sessions.0001_initial... OK
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).
February 01, 2021 - 00:00:00
Django version 3.1.5, using settings &#39;backend.settings&#39;
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>You should see the rocket ship animation with the message:</p><blockquote><p>The install worked successfully! Congratulations!</p></blockquote><p>Note that a file called <code>db.sqlite3</code> was created in <code>backend/</code>. Django uses a default SQLite file-based database for simplicity. We will use Postgres instead of sqlite3, but we will make this change later. For our purposes, SQLite and Postgres function similarly in our local development environment.</p><h2 id="settings-py-file-change-secret-key" tabindex="-1"><a class="header-anchor" href="#settings-py-file-change-secret-key" aria-hidden="true">#</a> <code>settings.py</code> file change: <code>SECRET_KEY</code></h2><p>By default, Django includes an automatically-generated, hard-coded sensitive value in our settings file called <code>SECRET_KEY</code>.</p><p>Open <code>backend/backend/settings.py</code> and change <code>SECRET_KEY</code> to the following:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>SECRET_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;SECRET_KEY&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;my-secret-key&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>also, add the following line to the top of the same file:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> os
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This tells our settings file to use the environment variable called <code>SECRET_KEY</code> as the value for the Django settings called <code>SECRET_KEY</code>. If there is no environment variable called <code>SECRET_KEY</code>, the value of <code>my-secret-key</code> will be used as a fallback. At this point we haven&#39;t set any environment variables yet, so the value of <code>my-secret-key</code> will be used in our local development environment. Using a fallback value for the <code>SECRET_KEY</code> setting is probably not a good idea. If we forget to set a secure <code>SECRET_KEY</code> value in our production environment, we don&#39;t want to use a non-secure <code>SECRET_KEY</code> value like <code>my-secret-key</code>, so we will remove the default setting and set the <code>SECRET_KEY</code> value explicitly in both the local and production environments.</p><h2 id="settings-py-file-change-debug" tabindex="-1"><a class="header-anchor" href="#settings-py-file-change-debug" aria-hidden="true">#</a> <code>settings.py</code> file change: <code>DEBUG</code></h2><p>We also don&#39;t want to hard-code the <code>DEBUG</code> setting, so this setting value can be changed to:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>DEBUG <span class="token operator">=</span> <span class="token builtin">bool</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;DEBUG&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This uses a <code>True</code> default value for <code>DEBUG</code> if the <code>DEBUG</code> environment variable is not set.</p><h2 id="move-backend-backend-settings-py-to-backend-backend-settings-base-py-and-add-backend-backend-settings-init-py" tabindex="-1"><a class="header-anchor" href="#move-backend-backend-settings-py-to-backend-backend-settings-base-py-and-add-backend-backend-settings-init-py" aria-hidden="true">#</a> Move <code>backend/backend/settings.py</code> to <code>backend/backend/settings/base.py</code> and add `backend/backend/settings/<strong>init</strong>.py</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir backend/backend/settings &amp;&amp; touch backend/backend/settings/__init__.py &amp;&amp; mv backend/backend/settings.py backend/backend/settings/base.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>If we try to restart the server, we will see that it doesn&#39;t work:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django.core.exceptions.ImproperlyConfigured: The SECRET_KEY setting must not be empty.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="change-the-value-of-base-dir" tabindex="-1"><a class="header-anchor" href="#change-the-value-of-base-dir" aria-hidden="true">#</a> Change the value of <code>BASE_DIR</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>BASE_DIR <span class="token operator">=</span> Path<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>resolve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We need to add another <code>.parent</code> since the settings module used is now one layer deeper</p><h2 id="create-backend-backend-settings-development-py" tabindex="-1"><a class="header-anchor" href="#create-backend-backend-settings-development-py" aria-hidden="true">#</a> Create <code>backend/backend/settings/development.py</code></h2><p>The <code>base.py</code> settings module will be used for defining settings that are common to both the development and production environment. We will define development-specific settings in another file that will inherit values from <code>base.py</code>. Create this file:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;from .base import *  # noqa&quot; &gt;&gt; backend/backend/settings/development.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="change-django-settings-module-in-backend-manage-py-again" tabindex="-1"><a class="header-anchor" href="#change-django-settings-module-in-backend-manage-py-again" aria-hidden="true">#</a> Change <code>DJANGO_SETTINGS_MODULE</code> in <code>backend/manage.py</code> again</h2><p>Now change the default <code>DJANGO_SETTINGS_MODULE</code> value to <code>backend.settings.development</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;backend.settings.development&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-requirements-folder-with-three-files-base-txt-dev-txt-and-test-txt" tabindex="-1"><a class="header-anchor" href="#add-a-requirements-folder-with-three-files-base-txt-dev-txt-and-test-txt" aria-hidden="true">#</a> Add a requirements folder with three files: <code>base.txt</code>, <code>dev.txt</code> and <code>test.txt</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir backend/requirements &amp;&amp; touch backend/requirements/{base,dev,test}.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>In <code>base.txt</code>, add the only dependency that we have so far, which is Django:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;Django==3.1.5&quot; &gt;&gt; backend/requirements/base.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><code>base.txt</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Django==3.1.5
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We will add new requirements to these three development files as we build out our project.</p><p>The new project directory structure looks like this:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ tree -L 3 backend/
backend/
â”œâ”€â”€ backend
â”‚   â”œâ”€â”€ asgi.py
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ __pycache__
â”‚   â”‚   â”œâ”€â”€ __init__.cpython-38.pyc
â”‚   â”‚   â”œâ”€â”€ settings.cpython-38.pyc
â”‚   â”‚   â”œâ”€â”€ urls.cpython-38.pyc
â”‚   â”‚   â””â”€â”€ wsgi.cpython-38.pyc
â”‚   â”œâ”€â”€ settings
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ development.py
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ __pycache__
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€ db.sqlite3
â”œâ”€â”€ manage.py
â””â”€â”€ requirements
    â”œâ”€â”€ base.txt
    â”œâ”€â”€ dev.txt
    â””â”€â”€ test.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="install-django-debug-toolbar" tabindex="-1"><a class="header-anchor" href="#install-django-debug-toolbar" aria-hidden="true">#</a> Install Django Debug Toolbar</h2><p>Django Debug Toolbar is a great tool for debugging several different aspects of Django, including ORM optimizations, caching, etc.</p><p>The installation instructions from <a href="https://django-debug-toolbar.readthedocs.io/en/latest/installation.html" target="_blank" rel="noopener noreferrer">here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> are pretty straightforward. Instead of running <code>python -m pip install django-debug-toolbar</code>, we can add that dependency directly to our project&#39;s <code>requirements/dev.txt</code> file since the Django Debug Toolbar should only be used in local development.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;django-debug-toolbar==3.2&quot; &gt;&gt; backend/requirements/dev.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Next, install the dependencies:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pip install -r backend/requirements/dev.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Next there are some Django settings to change. Similar to how we only want the Debug Toolbar installed in our project dependencies for our local development environment, the settings to enable the debug toolbar should only be used in the development environment. This is exactly what the <code>backend/backend/settings/development.py</code> file is for. We will make the following changes in the <code>development.py</code> settings file:</p><ul><li>Add <code>&#39;debug_toolbar&#39;,</code> to <code>INSTALLED_APPS</code></li><li>Add Debug Toolbar to URLconf</li><li>Add Debug Toolbar to middleware</li></ul><p>Here&#39;s the documentation for Django Debug Toolbar:</p><p><a href="https://django-debug-toolbar.readthedocs.io/en/1.0/configuration.html" target="_blank" rel="noopener noreferrer">https://django-debug-toolbar.readthedocs.io/en/1.0/configuration.html<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>Consider adding some options for the debug toolbar in the <code>development</code> settings module:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DEBUG_TOOLBAR_CONFIG = {
    &quot;SHOW_COLLAPSED&quot;: True,
}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="add-debug-toolbar-to-installed-apps" tabindex="-1"><a class="header-anchor" href="#add-debug-toolbar-to-installed-apps" aria-hidden="true">#</a> Add <code>debug_toolbar</code> to <code>INSTALLED_APPS</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># backend/backend/settings/development.py</span>
INSTALLED_APPS <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token string">&#39;debug_toolbar&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="add-urlconf-for-debug-toolbar" tabindex="-1"><a class="header-anchor" href="#add-urlconf-for-debug-toolbar" aria-hidden="true">#</a> Add URLconf for debug toolbar</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> debug_toolbar
<span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&#39;admin/&#39;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">if</span> settings<span class="token punctuation">.</span>DEBUG<span class="token punctuation">:</span>
    urlpatterns <span class="token operator">+=</span> <span class="token punctuation">[</span>
        path<span class="token punctuation">(</span><span class="token string">&#39;__debug__/&#39;</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>debug_toolbar<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="add-debug-toolbar-to-middleware" tabindex="-1"><a class="header-anchor" href="#add-debug-toolbar-to-middleware" aria-hidden="true">#</a> Add debug toolbar to middleware</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># backend/backend/settings/development.py</span>
MIDDLEWARE <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token string">&#39;debug_toolbar.middleware.DebugToolbarMiddleware&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="set-internal-ips-for-debug-toolbar" tabindex="-1"><a class="header-anchor" href="#set-internal-ips-for-debug-toolbar" aria-hidden="true">#</a> Set <code>INTERNAL_IPS</code> for debug toolbar</h2><p>From the Django Debug Toolbar docs:</p><blockquote><p>The Debug Toolbar is shown only if your IP address is listed in the <code>INTERNAL_IPS</code> setting.</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># backend/backend/settings/development.py</span>
INTERNAL_IPS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;127.0.0.1&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="create-a-superuser-with-createsuperuser" tabindex="-1"><a class="header-anchor" href="#create-a-superuser-with-createsuperuser" aria-hidden="true">#</a> Create a superuser with <code>createsuperuser</code></h2><p>At this point we have a very basic Django application. Django projects are created with a fully-featured admin. The admin is an interface where you can easily create, read, update and delete items from your database. We can view the admin by visiting <code>http://127.0.0.1:8000/admin</code>. This should prompt us for a username and password. We have to create this with the <code>createsuperuser</code> management command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DJANGO_SUPERUSER_PASSWORD=Qazwsx1! DJANGO_SUPERUSER_USERNAME=brian DJANGO_SUPERUSER_EMAIL=brian@email.com backend/manage.py createsuperuser --no-input
Superuser created successfully.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This command will create the necessary environment variables for the username, email and password for the superuser and create that user without prompting you to type these in the terminal. Try logging in with these credentials to make sure that everything works.</p><h2 id="rename-the-admin-url-optional" tabindex="-1"><a class="header-anchor" href="#rename-the-admin-url-optional" aria-hidden="true">#</a> Rename the <code>/admin</code> URL (Optional)</h2><p>To prevent bots from trying to login to our admin, it is a good idea change the default URL path that Django sets for the Django admin. Let&#39;s change <code>admin/</code> to <code>my-admin-portal/</code>:</p><p><code>backend/backend/urls.py</code> should now look like this</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&#39;my-admin-portal/&#39;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="setup-a-django-app-called-core" tabindex="-1"><a class="header-anchor" href="#setup-a-django-app-called-core" aria-hidden="true">#</a> Setup a Django app called <code>core</code></h2><p>Next we will add the first app to this Django project. Apps are Django&#39;s way of encapsulating logic. My Django projects typically have three apps: <code>core</code>, <code>accounts</code> and some other app that contains the majority of my project&#39;s logic.</p><p>I use the <code>core</code> app for models, views, middleware and other logic that isn&#39;t directly related to our application&#39;s logic. For example, a view that is used for application health checks, a model that is used for logging all requests, and a middleware used to save a record in our database for each request. We will implement these later, but for now let&#39;s just add the <code>core</code> app:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir -p backend/apps/core &amp;&amp; django-admin startapp core ./backend/apps/core
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>The <code>core</code> app is created in a folder called <code>apps</code> in the top-level <code>backend/</code> directory.</p><p>When we add this app to <code>INSTALLED_APPS</code> in our <code>base.py</code> settings file, we need to add it like this:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&#39;django.contrib.admin&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;django.contrib.auth&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;django.contrib.contenttypes&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;django.contrib.sessions&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;django.contrib.messages&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;django.contrib.staticfiles&#39;</span><span class="token punctuation">,</span>

    <span class="token string">&#39;apps.core&#39;</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="setup-a-django-app-called-accounts" tabindex="-1"><a class="header-anchor" href="#setup-a-django-app-called-accounts" aria-hidden="true">#</a> Setup a Django app called <code>accounts</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir -p backend/apps/accounts &amp;&amp; django-admin startapp accounts ./backend/apps/accounts
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Add <code>&#39;apps.accounts&#39;</code> to <code>INSTALLED_APPS</code> in <code>base.py</code></p><h2 id="setup-a-custom-user-model" tabindex="-1"><a class="header-anchor" href="#setup-a-custom-user-model" aria-hidden="true">#</a> Setup a Custom User Model</h2><p>Reference: <a href="https://testdriven.io/blog/django-custom-user-model/" target="_blank" rel="noopener noreferrer">https://testdriven.io/blog/django-custom-user-model/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>I have been using the steps described in this article in my recent Django projects for setting up a custom user model. This is a comprehensive guide that covers:</p><ul><li>Tests</li><li>ModelManager</li><li>Model</li><li>Forms</li><li>Admin</li><li>Settings</li></ul><p>Setting a custom user model is important to do early in the development of your project (if it is something your project requires)</p><p>We can start by creating the custom user model:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># accounts/models.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> AbstractUser
<span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>translation <span class="token keyword">import</span> gettext_lazy <span class="token keyword">as</span> _

<span class="token keyword">from</span> <span class="token punctuation">.</span>managers <span class="token keyword">import</span> CustomUserManager


<span class="token keyword">class</span> <span class="token class-name">CustomUser</span><span class="token punctuation">(</span>AbstractUser<span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> <span class="token boolean">None</span>
    email <span class="token operator">=</span> models<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>_<span class="token punctuation">(</span><span class="token string">&#39;email address&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    USERNAME_FIELD <span class="token operator">=</span> <span class="token string">&#39;email&#39;</span>
    REQUIRED_FIELDS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    objects <span class="token operator">=</span> CustomUserManager<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>email
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="set-auth-user-model-accounts-customuser-in-base-py-settings" tabindex="-1"><a class="header-anchor" href="#set-auth-user-model-accounts-customuser-in-base-py-settings" aria-hidden="true">#</a> Set <code>AUTH_USER_MODEL = &#39;accounts.CustomUser&#39;</code> in <code>base.py</code> settings</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>AUTH_USER_MODEL <span class="token operator">=</span> <span class="token string">&#39;accounts.CustomUser&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><strong>Note</strong>: we don&#39;t set <code>AUTH_USER_MODEL</code> to <code>apps.accounts.CustomUser</code></p><p>We can&#39;t run <code>makemigrations</code> just yet, we need to add the <code>CustomUserManager</code> for the <code>CustomUser</code> model.</p><h2 id="add-customusermanager-for-customuser-model" tabindex="-1"><a class="header-anchor" href="#add-customusermanager-for-customuser-model" aria-hidden="true">#</a> Add <code>CustomUserManager</code> for <code>CustomUser</code> model</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/accounts/managers.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>base_user <span class="token keyword">import</span> BaseUserManager
<span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>translation <span class="token keyword">import</span> gettext_lazy <span class="token keyword">as</span> _


<span class="token keyword">class</span> <span class="token class-name">CustomUserManager</span><span class="token punctuation">(</span>BaseUserManager<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Custom user model manager where email is the unique identifiers
    for authentication instead of usernames.
    &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">create_user</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token operator">**</span>extra_fields<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Create and save a User with the given email and password.
        &quot;&quot;&quot;</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> email<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>_<span class="token punctuation">(</span><span class="token string">&#39;The Email must be set&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> self<span class="token punctuation">.</span>normalize_email<span class="token punctuation">(</span>email<span class="token punctuation">)</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>email<span class="token operator">=</span>email<span class="token punctuation">,</span> <span class="token operator">**</span>extra_fields<span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>password<span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user

    <span class="token keyword">def</span> <span class="token function">create_superuser</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token operator">**</span>extra_fields<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Create and save a SuperUser with the given email and password.
        &quot;&quot;&quot;</span>
        extra_fields<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">&#39;is_staff&#39;</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
        extra_fields<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">&#39;is_superuser&#39;</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
        extra_fields<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">&#39;is_active&#39;</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> extra_fields<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;is_staff&#39;</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>_<span class="token punctuation">(</span><span class="token string">&#39;Superuser must have is_staff=True.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> extra_fields<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;is_superuser&#39;</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span>_<span class="token punctuation">(</span><span class="token string">&#39;Superuser must have is_superuser=True.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token operator">**</span>extra_fields<span class="token punctuation">)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="add-forms-for-customuser-admin" tabindex="-1"><a class="header-anchor" href="#add-forms-for-customuser-admin" aria-hidden="true">#</a> Add forms for CustomUser admin</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>forms <span class="token keyword">import</span> UserCreationForm<span class="token punctuation">,</span> UserChangeForm

<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> CustomUser


<span class="token keyword">class</span> <span class="token class-name">CustomUserCreationForm</span><span class="token punctuation">(</span>UserCreationForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">(</span>UserCreationForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> CustomUser
        fields <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">CustomUserChangeForm</span><span class="token punctuation">(</span>UserChangeForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> CustomUser
        fields <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="add-customuser-admin" tabindex="-1"><a class="header-anchor" href="#add-customuser-admin" aria-hidden="true">#</a> Add CustomUser admin</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>admin <span class="token keyword">import</span> UserAdmin

<span class="token keyword">from</span> <span class="token punctuation">.</span>forms <span class="token keyword">import</span> CustomUserCreationForm<span class="token punctuation">,</span> CustomUserChangeForm
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> CustomUser


<span class="token keyword">class</span> <span class="token class-name">CustomUserAdmin</span><span class="token punctuation">(</span>UserAdmin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    add_form <span class="token operator">=</span> CustomUserCreationForm
    form <span class="token operator">=</span> CustomUserChangeForm
    model <span class="token operator">=</span> CustomUser
    list_display <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;is_staff&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;is_active&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    list_filter <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;is_staff&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;is_active&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    fieldsets <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;fields&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">&quot;Permissions&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;fields&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">&quot;is_staff&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;is_active&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    add_fieldsets <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span>
            <span class="token boolean">None</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;classes&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">&quot;wide&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">&quot;fields&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>
                    <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;password1&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;password2&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;is_staff&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;is_active&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    search_fields <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>


admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span>CustomUser<span class="token punctuation">,</span> CustomUserAdmin<span class="token punctuation">)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="add-tests-for-the-customuser-model" tabindex="-1"><a class="header-anchor" href="#add-tests-for-the-customuser-model" aria-hidden="true">#</a> Add tests for the <code>CustomUser</code> model</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/accounts/tests.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> get_user_model


<span class="token keyword">class</span> <span class="token class-name">UsersManagersTests</span><span class="token punctuation">(</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">test_create_user</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>email<span class="token operator">=</span><span class="token string">&#39;normal@user.com&#39;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>user<span class="token punctuation">.</span>email<span class="token punctuation">,</span> <span class="token string">&#39;normal@user.com&#39;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>user<span class="token punctuation">.</span>is_active<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertFalse<span class="token punctuation">(</span>user<span class="token punctuation">.</span>is_staff<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertFalse<span class="token punctuation">(</span>user<span class="token punctuation">.</span>is_superuser<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># username is None for the AbstractUser option</span>
            <span class="token comment"># username does not exist for the AbstractBaseUser option</span>
            self<span class="token punctuation">.</span>assertIsNone<span class="token punctuation">(</span>user<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
        <span class="token keyword">except</span> AttributeError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">with</span> self<span class="token punctuation">.</span>assertRaises<span class="token punctuation">(</span>TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> self<span class="token punctuation">.</span>assertRaises<span class="token punctuation">(</span>TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>email<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> self<span class="token punctuation">.</span>assertRaises<span class="token punctuation">(</span>ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>email<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_create_superuser</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
        admin_user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_superuser<span class="token punctuation">(</span><span class="token string">&#39;super@user.com&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>admin_user<span class="token punctuation">.</span>email<span class="token punctuation">,</span> <span class="token string">&#39;super@user.com&#39;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>admin_user<span class="token punctuation">.</span>is_active<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>admin_user<span class="token punctuation">.</span>is_staff<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>admin_user<span class="token punctuation">.</span>is_superuser<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># username is None for the AbstractUser option</span>
            <span class="token comment"># username does not exist for the AbstractBaseUser option</span>
            self<span class="token punctuation">.</span>assertIsNone<span class="token punctuation">(</span>admin_user<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
        <span class="token keyword">except</span> AttributeError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">with</span> self<span class="token punctuation">.</span>assertRaises<span class="token punctuation">(</span>ValueError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_superuser<span class="token punctuation">(</span>
                email<span class="token operator">=</span><span class="token string">&#39;super@user.com&#39;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">,</span> is_superuser<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="run-makemigrations-and-migrate-management-command" tabindex="-1"><a class="header-anchor" href="#run-makemigrations-and-migrate-management-command" aria-hidden="true">#</a> Run <code>makemigrations</code> and <code>migrate</code> management command</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>./backend/manage.py makemigrations
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ ./backend/manage.py makemigrations
Migrations for &#39;accounts&#39;:
  backend/apps/accounts/migrations/0001_initial.py
    - Create model CustomUser
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>When we try to run <code>migrate</code>, there will be an error:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django.db.migrations.exceptions.InconsistentMigrationHistory: Migration admin.0001_initial is applied before its dependency accounts.0001_initial on database &#39;default&#39;.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>At this point, we can remove the <code>db.sqlite3</code> file and rerun the migrate command.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>rm backend/db.sqlite3 &amp;&amp; ./backend/manage.py migrate
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="run-the-tests" tabindex="-1"><a class="header-anchor" href="#run-the-tests" aria-hidden="true">#</a> Run the tests</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ ./backend/manage.py test backend/apps/accounts
Creating test database for alias &#39;default&#39;...
System check identified no issues (0 silenced).
..
----------------------------------------------------------------------
Ran 2 tests in 0.246s

OK
Destroying test database for alias &#39;default&#39;...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Running <code>./manage.py test</code> from the root of the project won&#39;t work, so you need to either cd to the directory or run the command specifying the app or apps you want to test. We can add this to an alias or a <code>make</code> command like this:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># Makefile</span>
<span class="token key atrule">.PHONY</span><span class="token punctuation">:</span> pytest
<span class="token key atrule">pytest</span><span class="token punctuation">:</span>
	<span class="token comment"># Running Django test suite</span>
	backend/manage.py test backend/apps
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="install-pytest" tabindex="-1"><a class="header-anchor" href="#install-pytest" aria-hidden="true">#</a> Install pytest</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;pytest==6.2.2&quot; &gt;&gt; backend/backend/settings/test.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Since this dependency will be used only in testing, we can add it to the <code>test.txt</code> file. Next, install the requirements listed in this file (pytest) so we can use the <code>pytest</code> command at the command line.</p><p>We will also use the <code>pytest-django</code> plugin:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &quot;pytest-django 4.1.0&quot; &gt;&gt; backend/backend/settings/test.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Now install these dependencies with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pip install -r backend/requirements/test.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Running pytest from our project root will make it impossible for <code>pytest</code> to find any tests. Additional configuration for pytest needs to be added so that pytest can find and run tests.</p><h2 id="add-pytest-ini-to-configure-pytest" tabindex="-1"><a class="header-anchor" href="#add-pytest-ini-to-configure-pytest" aria-hidden="true">#</a> Add <code>pytest.ini</code> to configure <code>pytest</code></h2><p>Add the following file called <code>pytest.ini</code> to the root of the top-level <code>backend</code> directory:</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">pytest</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">DJANGO_SETTINGS_MODULE</span> <span class="token punctuation">=</span> <span class="token value attr-value">backend.settings.development</span>
<span class="token key attr-name">python_files</span> <span class="token punctuation">=</span> <span class="token value attr-value">tests.py test_*.py *_tests.py</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>With setting we can invoke <code>pytest</code> by running:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pytest backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>in the root of our project directory. If running from the backend folder, you can simply invoke <code>pytest</code> with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pytest
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-pytest-command-to-makefile" tabindex="-1"><a class="header-anchor" href="#add-pytest-command-to-makefile" aria-hidden="true">#</a> Add pytest command to Makefile</h2><p>Let&#39;s add this as a <code>make</code> command by adding the following to our <code>Makefile</code>:</p><div class="language-Makefile ext-Makefile line-numbers-mode"><pre class="language-Makefile"><code>.PHONY: pytest
pytest:
	# Running pytest tests
	pytest backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="setup-code-coverage-reports" tabindex="-1"><a class="header-anchor" href="#setup-code-coverage-reports" aria-hidden="true">#</a> Setup code coverage reports</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># backend/requirements/test.txt

pytest-cov==2.11.1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Reinstall this file with <code>pip install -r backend/requirements/test.txt</code> and run:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pytest backend --cov=backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This will give a coverage report:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>----------- coverage: platform linux, python 3.8.7-final-0 -----------
Name                                               Stmts   Miss  Cover
----------------------------------------------------------------------
backend/__init__.py                                    0      0   100%
backend/apps/accounts/__init__.py                      0      0   100%
backend/apps/accounts/admin.py                         1      0   100%
backend/apps/accounts/managers.py                     20      1    95%
backend/apps/accounts/migrations/0001_initial.py       6      0   100%
backend/apps/accounts/migrations/__init__.py           0      0   100%
backend/apps/accounts/models.py                       12      1    92%
backend/apps/accounts/tests.py                        33      4    88%
backend/apps/core/__init__.py                          0      0   100%
backend/apps/core/admin.py                             1      0   100%
backend/apps/core/migrations/__init__.py               0      0   100%
backend/apps/core/models.py                            1      0   100%
backend/apps/core/tests.py                             1      0   100%
backend/backend/__init__.py                            0      0   100%
backend/backend/asgi.py                                4      4     0%
backend/backend/settings/__init__.py                   0      0   100%
backend/backend/settings/base.py                      20      0   100%
backend/backend/settings/development.py                4      0   100%
backend/backend/urls.py                                7      7     0%
backend/backend/wsgi.py                                4      4     0%
backend/manage.py                                     12     12     0%
----------------------------------------------------------------------
TOTAL                                                126     33    74%
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="write-browsable-coverage-to-a-directory-and-view-with-simple-http-server" tabindex="-1"><a class="header-anchor" href="#write-browsable-coverage-to-a-directory-and-view-with-simple-http-server" aria-hidden="true">#</a> Write browsable coverage to a directory and view with simple HTTP server</h2><p>Run pytest with the following options:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pytest backend --cov=backend --cov-report html:backend/.coverage
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then run a simple local file server</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>python -m http.server 8002 --directory backend/.coverage
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><a href="http://localhost:8002" target="_blank" rel="noopener noreferrer">http://localhost:8002<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> will open the code coverage report.</p><p><code>.coverage</code> is already included in the <code>.gitignore</code> file that was included originally, so generating the coverage report at this location will not add anything to git.</p><p>More options for pytest-cov can be found here: <a href="https://pytest-cov.readthedocs.io/en/latest/reporting.html" target="_blank" rel="noopener noreferrer">https://pytest-cov.readthedocs.io/en/latest/reporting.html<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="add-coveragerc-to-exclude-files-from-coverage-report" tabindex="-1"><a class="header-anchor" href="#add-coveragerc-to-exclude-files-from-coverage-report" aria-hidden="true">#</a> Add <code>.coveragerc</code> to exclude files from coverage report</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># .coveragerc
[run]
omit = manage.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="configure-vscode-settings" tabindex="-1"><a class="header-anchor" href="#configure-vscode-settings" aria-hidden="true">#</a> Configure VSCode settings</h2><p>In order to do linting with <code>flake8</code> and formatting with <code>black</code>, VSCode needs some special settings:</p><p>Here&#39;s my VSCode configuration:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;python.pythonPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.local-env/bin/python&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;python.linting.flake8Enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;python.linting.pylintEnabled&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;python.linting.enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;editor.formatOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;python.formatting.provider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;python.formatting.blackPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.local-env/bin/black&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// flake8 has a default line-length of 79, so we use that for black as well</span>
  <span class="token property">&quot;python.formatting.blackArgs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;--line-length&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;79&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>These settings will automatically format Python code and do code linting to indicate errors that need fixing. <code>black</code> has a default line-length of 88 columns. Thi is the one setting to change in the <code>black</code> command line arguments in the VSCode project settings.</p><h2 id="python-code-linting-with-flake8" tabindex="-1"><a class="header-anchor" href="#python-code-linting-with-flake8" aria-hidden="true">#</a> Python code linting with flake8</h2><p>We will use flake8 in our python code tests together with <code>pytest</code>. Add the flake8 dependency to the <code>test.txt</code> requirements file:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>flake8==3.8.4
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>flake8 backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This shows lots of errors:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ flake8 backend
backend/manage.py:9:80: E501 line too long (83 &gt; 79 characters)
backend/apps/accounts/views.py:1:1: F401 &#39;django.shortcuts.render&#39; imported but unused
backend/apps/accounts/admin.py:1:1: F401 &#39;django.contrib.admin&#39; imported but unused
backend/apps/accounts/tests.py:9:80: E501 line too long (80 &gt; 79 characters)

...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Instead of manually going over each of these files and making the required formatting changes, we can install <code>black</code> as a way to automatically format all of the python code at once. <code>black</code> should be able to format most of the <code>E501 line too long</code> errors.</p><h2 id="format-python-code-with-black" tabindex="-1"><a class="header-anchor" href="#format-python-code-with-black" aria-hidden="true">#</a> Format python code with black</h2><p>First, install black by adding it to test dependencies (<code>test.txt</code>):</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>black==20.8b1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then run:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>black backend
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/accounts/apps.py
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/core/apps.py
reformatted /home/brian/gitlab/django-step-by-step/backend/backend/settings/development.py
reformatted /home/brian/gitlab/django-step-by-step/backend/backend/asgi.py
reformatted /home/brian/gitlab/django-step-by-step/backend/backend/wsgi.py
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/accounts/models.py
reformatted /home/brian/gitlab/django-step-by-step/backend/backend/urls.py
reformatted /home/brian/gitlab/django-step-by-step/backend/manage.py
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/accounts/managers.py
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/accounts/tests.py
reformatted /home/brian/gitlab/django-step-by-step/backend/backend/settings/base.py
reformatted /home/brian/gitlab/django-step-by-step/backend/apps/accounts/migrations/0001_initial.py
All done! âœ¨ ðŸ° âœ¨
12 files reformatted, 13 files left unchanged.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Now run <code>flake8 backend</code> to see how many errors there are:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-runserver-plus-and-werkzeug" tabindex="-1"><a class="header-anchor" href="#add-runserver-plus-and-werkzeug" aria-hidden="true">#</a> Add runserver_plus and Werkzeug</h2><p>Install dependencies for <code>runserver_plus</code> and <code>Werkzeug</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django-extensions==3.1.0
Werkzeug==1.0.1 # used for runserver_plus exception console
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Add the <code>django-extensions</code> app to <code>INSTALLED_APPS</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    <span class="token string">&#39;django_extensions&#39;</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><code>runserver_plus</code></p><h2 id="add-a-base-model-for-tracking-created-modified-timestamps" tabindex="-1"><a class="header-anchor" href="#add-a-base-model-for-tracking-created-modified-timestamps" aria-hidden="true">#</a> Add a base model for tracking created/modified timestamps</h2><p>Adding a base model can be useful for adding fields to models that will be included on most of the other models in our project.</p><p>Here&#39;s an example of a base model we can use in our project. This model will be added to our <code>core</code> Django app and is a typical example of why it helps to have a <code>core</code> or <code>common</code> app that can help to organize things that aren&#39;t specific to one app.</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token keyword">class</span> <span class="token class-name">BaseModel</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>

    created_on <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    modified_on <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    created_by <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        settings<span class="token punctuation">.</span>AUTH_USER_MODEL<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">&#39;%(app_label)s_%(class)s_created_by&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    modified_by <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        settings<span class="token punctuation">.</span>AUTH_USER_MODEL<span class="token punctuation">,</span>
        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
        on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>
        related_name<span class="token operator">=</span><span class="token string">&#39;%(app_label)s_%(class)s_modified_by&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        abstract <span class="token operator">=</span> <span class="token boolean">True</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>There&#39;s no need to run migrations since the model is <code>abstract</code>. This model can now be subclassed when making new models. This will be used shortly.</p><h2 id="add-settings-for-enabling-use-of-jupyter-notebooks" tabindex="-1"><a class="header-anchor" href="#add-settings-for-enabling-use-of-jupyter-notebooks" aria-hidden="true">#</a> Add settings for enabling use of Jupyter notebooks</h2><p>Add the following dependencies that will allow us to use Jupyter notebooks to work with our Django application in its own environment.</p><p><code>dev.txt</code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># for Jupyter notebooks
ipython==7.20.0
jupyter==1.0.0
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Add the following make command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PHONY: notebook
notebook:
	backend/manage.py shell_plus --notebook
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Running <code>make notebook</code> (or <code>backend/manage.py shell_plus --notebook</code>) will open up a Jupyter notebook in the browser. Click on <code>New</code> &gt; <code>Django Shell-Plus</code> and you can run <code>!pip freeze</code> to view the dependencies installed to confirm that the environment is correct.</p><p>In order to make ORM queries, the following must be ran in the notebook:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token operator">%</span>env DJANGO_ALLOW_ASYNC_UNSAFE<span class="token operator">=</span>true
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This will set the environment variable <code>DJANGO_ALLOW_ASYNC_UNSAFE</code> which we will allow for the execution database queries through the ORM, for example:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token operator">%</span>env DJANGO_ALLOW_ASYNC_UNSAFE<span class="token operator">=</span>true
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> get_user_model
User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>
users <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
users<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The <code>DJANGO_ALLOW_ASYNC_UNSAFE</code> environment variable can also be set in your shell before launching Jupyter notebook.</p><h2 id="setup-postgres-locally" tabindex="-1"><a class="header-anchor" href="#setup-postgres-locally" aria-hidden="true">#</a> Setup Postgres locally</h2><p>Run the following command to ensure that Postgres is install and running:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo service postgresql status
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>â— postgresql.service - PostgreSQL RDBMS
   Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: enabled)
   Active: active (exited) since Mon 2021-02-01 19:41:34 EST; 2min 49s ago
  Process: 5543 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
 Main PID: 5543 (code=exited, status=0/SUCCESS)

Feb 01 19:41:34 x1 systemd[1]: Starting PostgreSQL RDBMS...
Feb 01 19:41:34 x1 systemd[1]: Started PostgreSQL RDBMS.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Ubuntu 20.04 shows the following:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo service postgresql start
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo service postgresql status
12/main (port 5432): online
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="configure-our-django-application-to-use-our-local-postgres-service" tabindex="-1"><a class="header-anchor" href="#configure-our-django-application-to-use-our-local-postgres-service" aria-hidden="true">#</a> Configure our Django application to use our local postgres service</h2><p>The Postgres service is available at <code>localhost:5432</code>.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo -u postgres psql postgres
ALTER USER postgres WITH PASSWORD &#39;postgres&#39;;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Add <code>psycopg2</code> to our project dependencies (in <code>base.txt</code>):</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>psycopg2-binary==2.8.6
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Add the following settings to <code>base.py</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Database</span>
<span class="token comment"># https://docs.djangoproject.com/en/3.1/ref/settings/#databases</span>

DATABASES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;default&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;ENGINE&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;django.db.backends.postgresql_psycopg2&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;NAME&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;POSTGRES_NAME&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;postgres&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;USER&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;POSTGRES_USERNAME&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;postgres&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;PASSWORD&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;POSTGRES_PASSWORD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;postgres&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;HOST&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;POSTGRES_SERVICE_HOST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;PORT&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;POSTGRES_SERVICE_PORT&quot;</span><span class="token punctuation">,</span> <span class="token number">5432</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Now run the <code>migrate</code> management command and then <code>runserver</code> (or just run <code>make</code> to run the migrate command and start the development server).</p><h2 id="another-approach-to-running-postgres-on-our-machine-and-an-introduction-to-docker-run-postgres-in-a-docker-container" tabindex="-1"><a class="header-anchor" href="#another-approach-to-running-postgres-on-our-machine-and-an-introduction-to-docker-run-postgres-in-a-docker-container" aria-hidden="true">#</a> Another approach to running postgres on our machine and an introduction to docker: run postgres in a docker container</h2><p>Reference: <a href="https://hub.docker.com/_/postgres" target="_blank" rel="noopener noreferrer">https://hub.docker.com/_/postgres<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run -d \
    --name some-postgres \
    -p 5434:5432
    -e POSTGRES_PASSWORD=mysecretpassword \
    -v /tmp/pgdata:/var/lib/postgresql/data \
    postgres
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>You can access the psql shell with the following command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker exec -it some-postgres sh
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># psql -U postgres
psql (12.1 (Debian 12.1-1.pgdg100+1))
Type &quot;help&quot; for help.

postgres=#
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="improve-the-readability-of-the-command-by-using-docker-compose" tabindex="-1"><a class="header-anchor" href="#improve-the-readability-of-the-command-by-using-docker-compose" aria-hidden="true">#</a> Improve the readability of the command by using docker-compose</h2><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;2.4&quot;</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> postgres
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> main
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;5434:5432&quot;</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> pg<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/var/lib/postgresql/data
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> POSTGRES_PASSWORD=postgres

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">pg-data</span><span class="token punctuation">:</span>

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>We can use docker and docker-compose for &quot;dockerizing&quot; our application as much or as little as we want. Eventually I&#39;ll show how to fully dockerize all components of our application. This will simplify the process of starting the entire project locally and will also ensure that developers don&#39;t have any issues with running the application properly.</p><h2 id="setup-pgadmin4-locally" tabindex="-1"><a class="header-anchor" href="#setup-pgadmin4-locally" aria-hidden="true">#</a> Setup pgadmin4 locally</h2><p>Add <code>pgadmin4</code> to <code>dev.txt</code> and install the local dependencies (<strong><code>make pip-local</code></strong>).</p><p>If you see errors about log file permissions, run the following:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo mkdir /var/log/pgadmin
sudo chown -R $USER:$USER /var/log/pgadmin
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Run <code>pgadmin4</code> in a terminal with the virtual environment activated, then enter an email and password that you will use to login for the first time. Login to the program when it opens in the browser, enter your email and password and create a new server. User <code>postgres</code> for the name, user and password.</p><p>You can find the email that used to sign up here:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/var/lib/pgadmin/storage/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="setup-pgadmin4-in-docker-compose" tabindex="-1"><a class="header-anchor" href="#setup-pgadmin4-in-docker-compose" aria-hidden="true">#</a> Setup pgadmin4 in docker-compose</h2><h2 id="add-a-dockerfile-for-our-django-application" tabindex="-1"><a class="header-anchor" href="#add-a-dockerfile-for-our-django-application" aria-hidden="true">#</a> Add a Dockerfile for our Django application</h2><p>Now that the main dependency for our project (postgres) is running in docker, it is important to decide if the Django application itself should run as a containerized process in our local development environment. For most Django projects, either way is probably fine. If we don&#39;t use docker for running the Django application, then there is no problem with running it directly on the virtual environment as it has been running in up until now.</p><p>The main reasons why I choose to run project locally in docker are:</p><ul><li>it is easy to start everything at once with one command</li><li>it is a standard format and makes it easy for people to start a complex project quickly without setting anything up</li><li>it makes me more confident that something working correctly on my local docker environment will work on a remote server&#39;s docker environment as well.</li><li>it will make deployment easier and more predictable</li></ul><p>We need to do 2 things in order to start running our Django app in a container: write a Dockerfile and also provide some options for how to run the container.</p><p>First, we can start with this Dockerfile:</p><p><code>backend/Dockerfile.dev</code>:</p><div class="language-Dockerfile ext-Dockerfile line-numbers-mode"><pre class="language-Dockerfile"><code>FROM python:3.8-slim
ENV PYTHONUNBUFFERED 1
ENV PYTHONDONTWRITEBYTECODE 1
RUN mkdir /code
WORKDIR /code
ADD requirements/base.txt \
    requirements/dev.txt \
    requirements/test.txt \
    /code/requirements/
RUN pip3 install -r requirements/base.txt
RUN pip3 install -r requirements/dev.txt
RUN pip3 install -r requirements/test.txt
ADD . /code/
RUN useradd -m app
USER app
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Next, we need to think about how the container will run. Because there is no <code>EXEC</code> keyword in Dockerfile.dev, this Dockerfile doesn&#39;t tell the container what to do. Similar to how it was shown that postgres can be launched from the command line with command line arguments or from the <code>docker-compose</code> command that references a <code>docker-compose.yml</code> file, our containerized Django app can also be launched in these two ways.</p><p>Before we run the container, we need to build it. We can start with the <code>docker build</code> command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker build -t my-backend -f backend/Dockerfile.dev backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>You should see:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Successfully built 6aaa6b60ad17
Successfully tagged my-backend:latest
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>To run the container, use the following command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run -p 8000:8000 my-backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>What about postgres? If we run:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run -p 8000:8000 my-backend python3 manage.py runserver
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We will see the following error:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>        Is the server running on host &quot;localhost&quot; (::1) and accepting
        TCP/IP connections on port 5432?
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This is because the <code>localhost</code> on our browser is not the same as the <code>localhost</code> on our container.</p><p>To fix this, we need to run the docker container</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker run --network=host -p 8000:8000 my-backend python3 manage.py runserver_plus
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="setup-redis-locally" tabindex="-1"><a class="header-anchor" href="#setup-redis-locally" aria-hidden="true">#</a> Setup redis locally</h2><p><a href="https://redis.io/topics/quickstart" target="_blank" rel="noopener noreferrer">https://redis.io/topics/quickstart<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04" target="_blank" rel="noopener noreferrer">https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>Install redis:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo apt install redis-server
sudo apt install redis-tools
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Edit the configuration file so that redis uses <code>systemd</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo nano /etc/redis/redis.conf
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Change the following line in <code>redis.conf</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>supervised systemd
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Check on the status of the <code>redis-server</code> service:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo service redis-server status
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We can verify that redis works, but first install the py-redis client:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># base.txt

redis==3.5.3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Run <strong><code>make pip-local</code></strong> to install the dependency to your local environment.</p><p>Redis stands for <code>remote dictionary service</code>. Using a Jupyter notebook or IPython, you can test the redis connection with:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> redis

REDIS_SERVICE_HOST <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;REDIS_SERVICE_HOST&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">)</span>

REDIS <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>
    host<span class="token operator">=</span>REDIS_SERVICE_HOST<span class="token punctuation">,</span>
    port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span>
    db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
    charset<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">,</span>
    decode_responses<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Redis will allow us to do several different things with our Django application:</p><ul><li><strong>caching</strong>: this refers to storing responses in redis so that database queries can be avoided. This is useful for expensive queries that will likely not change frequently and it will also result in a faster request/response cycle.</li><li><strong>async processing</strong>: redis will help us do long-running tasks on &quot;another computer&quot;, such as processing large files, sending emails, etc. Redis will keep track of the tasks that need to be processed. You can think about redis as a way to store python lists, dictionaries, sets, strings and numbers on a remote database. Redis offers some additional data types, as well. I&#39;ll use redis with <code>celery</code> later on.</li><li><strong>web sockets</strong>: redis will allow us to work with web sockets. This allows for real-time communication between the server and connected clients using web sockets.</li><li>more: there are likely other use cases that use redis. The examples listed here can usually use a number of different services such as <code>memcached</code> or <code>RabbitMQ</code>. A redis server can use dedicated numbered databases so that there is no possibility of key collision.</li></ul><p>Check the redis connection using the CLI command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># we can ping the local redis server with the following:
# redis-cli -h localhost -p 6379 ping
# the `-h` and `-p` arguments are the default host and port for redis-cli, so this is equivalent to:

redis-cli ping
PONG
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="add-redis-to-docker-compose-file-for-celery-broker" tabindex="-1"><a class="header-anchor" href="#add-redis-to-docker-compose-file-for-celery-broker" aria-hidden="true">#</a> Add redis to docker-compose file for celery broker</h2><h2 id="setup-redis-commander-locally" tabindex="-1"><a class="header-anchor" href="#setup-redis-commander-locally" aria-hidden="true">#</a> Setup redis-commander locally</h2><p>Similar to how we installed <code>pgadmin4</code> to give us a GUI for our Postgres database, we can also install a GUI for our redis database that will provide a similar functionality and will also give us visibility into how our Django application interacts with redis.</p><p>First, install redis-commander with <code>npm</code>. Check you node and npm versions with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>node -v
v15.0.1
npm -v
7.0.3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Install the program in our global npm modules:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm install -g redis-commander
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We can now see this installed in our global dependencies with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm list -g --depth=0
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Here are my globally installed npm packages:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm list -g --depth=0
/home/brian/.nvm/versions/node/v15.0.1/lib
â”œâ”€â”€ @quasar/cli@1.1.2
â”œâ”€â”€ aws-cdk@1.70.0
â”œâ”€â”€ generator-code@1.3.9
â”œâ”€â”€ npm@7.0.3
â”œâ”€â”€ redis-commander@0.7.0 &lt;-- this is what we just installed
â””â”€â”€ yo@3.1.1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Now start the redis-commander program with <code>redis-commander</code> and visit <code>http://127.0.0.1:8081</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>redis-commander
Using scan instead of keys
No Save: false
listening on 0.0.0.0:8081
access with browser at http://127.0.0.1:8081
Redis Connection localhost:6379 using Redis DB #0
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>You may need to add a new server in order to inspect a different redis database. Click on <code>More</code> &gt; <code>Add Server</code>, add a <code>Display-Name</code> and a <code>Database Index</code>.</p><h2 id="add-a-requestlog-model" tabindex="-1"><a class="header-anchor" href="#add-a-requestlog-model" aria-hidden="true">#</a> Add a RequestLog model</h2><p>Next let&#39;s add a model that will keep track of each request that is made to our application. On this model we will have the following fields:</p><ul><li><code>user</code> (Foreign key to user model, store on <code>created_by</code> field from base model)</li><li><code>date</code> (use <code>created_on</code> field from base model)</li><li><code>path</code> (<code>/api/resource/1/</code>)</li><li><code>full_path</code> (<code>/api/resource/1/?query=something</code>)</li><li><code>execution_time</code> (in milliseconds)</li><li><code>response_code</code> (<code>200</code>, <code>301</code>, <code>404</code>, <code>500</code>, etc.)</li><li><code>method</code> (<code>GET</code>, <code>POST</code>, etc.)</li><li><code>remote_address</code> (IP address of connecting client)</li></ul><p>Here&#39;s the model we can use:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/core/models.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> get_user_model


User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">RequestLog</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Request Log
    &quot;&quot;&quot;</span>

    user <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
        User<span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span>
    date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    path <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">)</span>
    full_path <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">)</span>
    execution_time <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    response_code <span class="token operator">=</span> models<span class="token punctuation">.</span>PositiveIntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    method <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    remote_address <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>Add this code and then run the <code>makemigrations</code> management command to add the migration file.</p><h2 id="add-a-middleware-to-handle-requestlog-creation" tabindex="-1"><a class="header-anchor" href="#add-a-middleware-to-handle-requestlog-creation" aria-hidden="true">#</a> Add a middleware to handle RequestLog creation</h2><p>Next we need to add a middleware that will create and save a <code>RequestLog</code> object on each request. We can use the following middleware:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/core/middleware.py</span>
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time

<span class="token keyword">from</span> core<span class="token punctuation">.</span>models <span class="token keyword">import</span> RequestLog

logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">RequestLogMiddleware</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> get_response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>get_response <span class="token operator">=</span> get_response

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        duration <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
        response_ms <span class="token operator">=</span> duration <span class="token operator">*</span> <span class="token number">1000</span>

        user <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">if</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>
            user <span class="token operator">=</span> request<span class="token punctuation">.</span>user
        path <span class="token operator">=</span> request<span class="token punctuation">.</span>path
        full_path <span class="token operator">=</span> request<span class="token punctuation">.</span>get_full_path<span class="token punctuation">(</span><span class="token punctuation">)</span>
        method <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
        remote_address <span class="token operator">=</span> self<span class="token punctuation">.</span>get_client_ip<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        response_code <span class="token operator">=</span> response<span class="token punctuation">.</span>status_code

        request_log <span class="token operator">=</span> RequestLog<span class="token punctuation">(</span>
            user<span class="token operator">=</span>user<span class="token punctuation">,</span>
            path<span class="token operator">=</span>path<span class="token punctuation">,</span>
            full_path<span class="token operator">=</span>full_path<span class="token punctuation">,</span>
            execution_time<span class="token operator">=</span>response_ms<span class="token punctuation">,</span>
            response_code<span class="token operator">=</span>response_code<span class="token punctuation">,</span>
            method<span class="token operator">=</span>method<span class="token punctuation">,</span>
            remote_address<span class="token operator">=</span>remote_address<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

        request_log<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> response

    <span class="token keyword">def</span> <span class="token function">get_client_ip</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x_forwarded_for <span class="token operator">=</span> request<span class="token punctuation">.</span>META<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> x_forwarded_for<span class="token punctuation">:</span>
            ip <span class="token operator">=</span> x_forwarded_for<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            ip <span class="token operator">=</span> request<span class="token punctuation">.</span>META<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;REMOTE_ADDR&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> ip
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>Add this middleware to Django&#39;s <code>MIDDLEWARE</code> settings value at the end of the list:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>MIDDLEWARE <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">&quot;apps.core.middleware.RequestLogMiddleware&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="add-an-admin-view-for-the-requestlog" tabindex="-1"><a class="header-anchor" href="#add-an-admin-view-for-the-requestlog" aria-hidden="true">#</a> Add an admin view for the RequestLog</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin

<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> RequestLog


<span class="token keyword">class</span> <span class="token class-name">RequestLogAdmin</span><span class="token punctuation">(</span>admin<span class="token punctuation">.</span>ModelAdmin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> RequestLog

    <span class="token keyword">def</span> <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        qs <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>RequestLogAdmin<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
        qs <span class="token operator">=</span> qs<span class="token punctuation">.</span>exclude<span class="token punctuation">(</span>full_path__startswith<span class="token operator">=</span><span class="token string">&quot;/admin/&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> qs

    search_fields <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;full_path&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

    list_select_related <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

    list_filter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;response_code&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>

    readonly_fields <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;full_path&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;execution_time&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;response_code&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;remote_address&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    list_display <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;full_path&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;execution_time&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;response_code&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;remote_address&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>


admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span>RequestLog<span class="token punctuation">,</span> RequestLogAdmin<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="setup-celery-app" tabindex="-1"><a class="header-anchor" href="#setup-celery-app" aria-hidden="true">#</a> Setup Celery app</h2><p>To setup celery, we need to do a few things:</p><ol><li>Add <code>celery</code> to our installed packages</li><li>Add a <code>celery_app.py</code> file to configure celery</li><li>Import celery in <code>backend/backend/__init__.py</code></li><li>Add settings to Django settings for celery</li><li>Define a celery task in our project code</li><li>Start a celery worker</li><li>Run the test task to confirm that it is working</li></ol><p>You can read more about celery here: <a href="https://docs.celeryproject.org/en/stable/getting-started/introduction.html" target="_blank" rel="noopener noreferrer">https://docs.celeryproject.org/en/stable/getting-started/introduction.html<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>Also, the celery documentation has some helpful Django-specific settings that will be used here: <a href="https://docs.celeryproject.org/en/stable/getting-started/introduction.html" target="_blank" rel="noopener noreferrer">https://docs.celeryproject.org/en/stable/getting-started/introduction.html<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>First, add celery to <code>requirements/base.txt</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>celery==5.0.5
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Now reinstall pip requirements.</p><h2 id="add-celery-app-py-to-backend-backend" tabindex="-1"><a class="header-anchor" href="#add-celery-app-py-to-backend-backend" aria-hidden="true">#</a> Add <code>celery_app.py</code> to <code>backend/backend</code></h2><p>Here&#39;s the contents for the <code>celery_app.py</code> file:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> celery <span class="token keyword">import</span> Celery
<span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings

app <span class="token operator">=</span> Celery<span class="token punctuation">(</span><span class="token string">&quot;backend&quot;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span>config_from_object<span class="token punctuation">(</span><span class="token string">&quot;django.conf:settings&quot;</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">&quot;CELERY&quot;</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span>autodiscover_tasks<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> settings<span class="token punctuation">.</span>INSTALLED_APPS<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="install-celery-in-backend-backend-init-py" tabindex="-1"><a class="header-anchor" href="#install-celery-in-backend-backend-init-py" aria-hidden="true">#</a> Install celery in <code>backend/backend/__init__.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># This will make sure the app is always imported when</span>
<span class="token comment"># Django starts so that shared_task will use this app.</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>celery <span class="token keyword">import</span> app <span class="token keyword">as</span> celery_app

__all__ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&#39;celery_app&#39;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="add-celery-settings-to-django-settings" tabindex="-1"><a class="header-anchor" href="#add-celery-settings-to-django-settings" aria-hidden="true">#</a> Add celery settings to Django settings</h2><p>Next the celery application can be configured in Django settings.</p><p>We need to tell celery about the redis server since this will be used as the broker.</p><p>You can think about the role that redis plays in the context of celery as a bulletin board.</p><p>In our Django application, we will post messages on the bulletin board. The contents of the bulletin board messages are all pretty simple. At a basic level, the messages will specify the name of a function defined in our Django project along with any arguments that should be passed to the function. Celery workers will constantly be checking the bulletin board for work and will take messages off of the board and start doing the work specified by the messages. That&#39;s celery in a nutshell. It can get a lot more complicated, but the bulletin board / worker analogy can be stretched to explain some of the more complex parts of celery&#39;s advanced features.</p><p>Here are the settings to add:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># use `localhost` as the Redis server hostname unless `REDIS_SERVICE_HOST` is provided</span>
REDIS_SERVICE_HOST <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;REDIS_SERVICE_HOST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
REDIS_PORT <span class="token operator">=</span> <span class="token number">6379</span>
BROKER_PORT <span class="token operator">=</span> <span class="token number">1</span>
RESULTS_PORT <span class="token operator">=</span> <span class="token number">2</span>

CELERY_BROKER_URL <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;redis://</span><span class="token interpolation"><span class="token punctuation">{</span>REDIS_SERVICE_HOST<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>REDIS_PORT<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>BROKER_PORT<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
CELERY_RESULT_BACKEND <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token string-interpolation"><span class="token string">f&quot;redis://</span><span class="token interpolation"><span class="token punctuation">{</span>REDIS_SERVICE_HOST<span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{</span>REDIS_PORT<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>RESULTS_PORT<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token punctuation">)</span>
CELERY_ACCEPT_CONTENT <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">]</span>
CELERY_TASK_SERIALIZER <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span>
CELERY_RESULT_SERIALIZER <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="add-a-debug-celery-task" tabindex="-1"><a class="header-anchor" href="#add-a-debug-celery-task" aria-hidden="true">#</a> Add a debug celery task</h2><p>The simplest celery task we can write simply sleeps for 1 second and then returns a success message.</p><p>We can write a simple task that sleeps for 1 second in the <code>core</code> app.</p><p>Create a new file <code>apps/core/tasks.py</code> with the following celery task:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> time

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>task</span><span class="token punctuation">(</span>queue<span class="token operator">=</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">process_filing_list</span><span class="token punctuation">(</span>filing_list_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="run-the-celery-command-to-start-a-worker" tabindex="-1"><a class="header-anchor" href="#run-the-celery-command-to-start-a-worker" aria-hidden="true">#</a> Run the celery command to start a worker</h2><p>In a new terminal window, activate the virtual environment and run the following from the root directory of the project:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then run</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DJANGO_SETTINGS_MODULE=backend.settings.development celery -A backend.celery_app:app worker -l INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code> -------------- celery@DESKTOP-VF05L4R v5.0.5 (singularity)
--- ***** -----
-- ******* ---- Linux-4.19.128-microsoft-standard-x86_64-with-glibc2.29 2021-03-06 21:59:44
- *** --- * ---
- ** ---------- [config]
- ** ---------- .&gt; app:         backend:0x7f9e8d48f880
- ** ---------- .&gt; transport:   redis://localhost:6379/1
- ** ---------- .&gt; results:     redis://localhost:6379/2
- *** --- * --- .&gt; concurrency: 8 (prefork)
-- ******* ---- .&gt; task events: OFF (enable -E to monitor tasks in this worker)
--- ***** -----
 -------------- [queues]
                .&gt; celery           exchange=celery(direct) key=celery


[tasks]
  . apps.core.tasks.debug_task

[2021-03-06 21:59:44,833: INFO/MainProcess] Connected to redis://localhost:6379/1
[2021-03-06 21:59:44,842: INFO/MainProcess] mingle: searching for neighbors
[2021-03-06 21:59:45,878: INFO/MainProcess] mingle: all alone
[2021-03-06 21:59:45,884: WARNING/MainProcess] /home/brian/gitlab/django-step-by-step/.local-env/lib/python3.8/site-packages/celery/fixups/django.py:203: UserWarning: Using settings.DEBUG leads to a memory
            leak, never use this setting in production environments!
  warnings.warn(&#39;&#39;&#39;Using settings.DEBUG leads to a memory

[2021-03-06 21:59:45,884: INFO/MainProcess] celery@DESKTOP-VF05L4R ready.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="run-the-debug-task" tabindex="-1"><a class="header-anchor" href="#run-the-debug-task" aria-hidden="true">#</a> Run the debug task</h2><p>Now that we have a celery worker running, we are ready to post messages to our bulletin board. Let&#39;s open a Jupyter notebook and see how message are sent to redis (the bulletin). First, open a Jupyter notebook <code>Django Shell-Plus</code> session with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>make notebook
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>In a new notebook, run the following command:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> time
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>core<span class="token punctuation">.</span>tasks <span class="token keyword">import</span> debug_task

<span class="token comment"># calling `.delay` is what &quot;posts&quot; the message to redis (the bulletin board)</span>
task <span class="token operator">=</span> debug_task<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task ID is: </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task status is: </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task successful? </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>successful<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Type: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">type</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;waiting 2 seconds (the task should have been completed by now)&quot;</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task status: </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>status<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task successful? </span><span class="token interpolation"><span class="token punctuation">{</span>task<span class="token punctuation">.</span>successful<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Task ID is: 21846505-1473-4ba4-9544-dc969b6aa02c
Task status is: PENDING
Task successful? False
Type: &lt;class &#39;celery.result.AsyncResult&#39;&gt;
waiting 2 seconds (the task should have been completed by now)
Task status: SUCCESS
Task successful? True
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Notice that the terminal window in which we started the celery worker now has some output in the logs:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[2021-03-06 22:22:51,686: INFO/MainProcess] Received task: apps.core.tasks.debug_task[21846505-1473-4ba4-9544-dc969b6aa02c]
[2021-03-06 22:22:52,692: INFO/ForkPoolWorker-7] Task apps.core.tasks.debug_task[21846505-1473-4ba4-9544-dc969b6aa02c] succeeded in 1.0044008000113536s: &#39;Debug task slept for 1 second.&#39;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>We see that the task was received, and that it took about 1 second to complete (the length of time for which the task called <code>sleep</code>) and we see the task&#39;s result, which is the string <code>Debug task slept for 1 second.</code></p><h2 id="setup-watchdog-command-for-celery" tabindex="-1"><a class="header-anchor" href="#setup-watchdog-command-for-celery" aria-hidden="true">#</a> Setup watchdog command for celery</h2><p>If we want to change the length of time that the debug task sleeps for, then we will need to stop the celery worker and restart. As you develop tasks, stopping and restarting the celery worker can be tedious. We can have the celery worker restart automatically on code changes similar to how the Django development server (<code>runserver</code>, also <code>runserver_plus</code> that we are using) restarts automatically on code changes. To do this, we can use a package in our local development environment called <code>watchdog</code>.</p><p>Add the following to <code>requirements/dev.txt</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>watchdog==0.10.3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>And then reinstall pip requirements with <code>make pip-local</code>.</p><p>Stop the current celery worker by pressing <code>Ctrl+C</code> in the terminal window, and then run the celery command again with watchdog (make sure you are running this from the <code>backend</code> directory):</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DJANGO_SETTINGS_MODULE=backend.settings.development watchmedo auto-restart --directory=./ --pattern=*.py --recursive -- celery -A backend.celery_app:app worker -l INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>To make this easier to read, we can also write this command as:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">DJANGO_SETTINGS_MODULE</span><span class="token operator">=</span>backend.settings.development <span class="token punctuation">\</span>
watchmedo <span class="token punctuation">\</span>
    auto-restart <span class="token punctuation">\</span>
    --directory<span class="token operator">=</span>./ <span class="token punctuation">\</span>
    --pattern<span class="token operator">=</span>*.py <span class="token punctuation">\</span>
    --recursive <span class="token punctuation">\</span>
    -- <span class="token punctuation">\</span>
    celery <span class="token punctuation">\</span>
    -A <span class="token punctuation">\</span>
    backend.celery_app:app <span class="token punctuation">\</span>
    worker <span class="token punctuation">\</span>
    -l <span class="token punctuation">\</span>
    INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Since this is a little bit verbose, we can add this command as a <code>make</code> command in our <code>Makefile</code>:</p><div class="language-Makefile ext-Makefile line-numbers-mode"><pre class="language-Makefile"><code>start-celery-default-worker:
	DJANGO_SETTINGS_MODULE=backend.settings.development watchmedo auto-restart --directory=./ --pattern=*.py --recursive -- celery -A backend.celery_app:app worker -l INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Now the celery worker will be restarted whenever we make code changes to the Django project. We do have to remember to run the command from the correct directory and to set the <code>DJANGO_SETTINGS_MODULE</code> environment variable</p><h2 id="setup-flower-for-celery-monitoring" tabindex="-1"><a class="header-anchor" href="#setup-flower-for-celery-monitoring" aria-hidden="true">#</a> Setup flower for celery monitoring</h2><p>Now that we have our celery worker running and processing tasks successfully, it would be good to add a tool to our project called <code>flower</code>. <code>flower</code> is a celery monitoring utility that provides a web interface for viewing task and worker status.</p><p>We can use flower in local development, but we can also use flower in production to monitor our tasks in a live environment. We can add the flower dependency to <code>dev.txt</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>flower==0.9.7
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>After re-installing dependencies, run the following command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DJANGO_SETTINGS_MODULE=backend.settings.development celery flower -A backend.celery_app:app --address=127.0.0.1 --port=5555
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[I 210306 23:17:22 command:135] Visit me at http://127.0.0.1:5555
[I 210306 23:17:22 command:142] Broker: redis://localhost:6379/1
[I 210306 23:17:22 command:143] Registered tasks:
    [&#39;apps.core.tasks.debug_task&#39;,
     &#39;celery.accumulate&#39;,
     &#39;celery.backend_cleanup&#39;,
     &#39;celery.chain&#39;,
     &#39;celery.chord&#39;,
     &#39;celery.chord_unlock&#39;,
     &#39;celery.chunks&#39;,
     &#39;celery.group&#39;,
     &#39;celery.map&#39;,
     &#39;celery.starmap&#39;]
[I 210306 23:17:22 mixins:229] Connected to redis://localhost:6379/1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Visiting <code>http://127.0.0.1:5555</code> should show that there is a celery worker online. Try stopping and restarting the celery worker and you can see that the worker <code>STATUS</code> changes from <code>Online</code> to <code>Offline</code> and then back to <code>Online</code>. Try running the celery task again from the Jupyter notebook and you should see 1 task in <code>Active</code> and <code>Processed</code> and then once the task finished we should see 1 task in the <code>Succeeded</code> column.</p><p>Celery can also be started with the following command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>flower -A backend.celery_app:app --broker=redis://localhost:6379/1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="decide-if-you-need-celery-tasks-always-eager-to-be-set-to-true" tabindex="-1"><a class="header-anchor" href="#decide-if-you-need-celery-tasks-always-eager-to-be-set-to-true" aria-hidden="true">#</a> Decide if you need <code>CELERY_TASKS_ALWAYS_EAGER</code> to be set to <code>True</code></h2><p>Depending on the type of celery tasks your app uses, you may or may not want to use a special Django setting that will run the task directly on the webserver and not on the worker. It can also be said that this setting runs the celery tasks synchronously when <code>CELERY_TASKS_ALWAYS_EAGER = True</code>. If your tasks involve simple steps like sending email or doing relatively fast processing, this might be fine.</p><p>If you want to simulate celery workers running in your local environment in a way similar that they would be running in production, you can also start different celery processes that can run one or more queues.</p><p>First it will be shown using the <code>CELERY_TASKS_ALWAYS_EAGER = True</code> setting, and second it will be shown how to use separate celery worker processes to simulate a production environment on a local development machine.</p><h2 id="setup-celery-beat-settings-periodics-tasks" tabindex="-1"><a class="header-anchor" href="#setup-celery-beat-settings-periodics-tasks" aria-hidden="true">#</a> Setup celery beat, settings, periodics tasks</h2><p>One nice feature of celery is that it allows us to easily schedule tasks that should be performed on regular intervals, similar to how cron jobs schedule tasks.</p><p>This is provided through a part of celery called <code>beat</code>.</p><p>To use celery, we need to define a <code>CELERY_BEAT_SCHEDULE</code> in Django settings and then start another process to start celery beat. This process will send messages to Redis (the bulletin board) at regular intervals that will be processed by celery workers.</p><p>We can use another &quot;debug&quot; task for celery beat:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@app.task
def celery_beat_debug_task():
    return &quot;Celery debug task complete.&quot;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="run-the-celery-beat-process" tabindex="-1"><a class="header-anchor" href="#run-the-celery-beat-process" aria-hidden="true">#</a> Run the celery beat process</h2><p>Run the following command to start celery beat:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">DJANGO_SETTINGS_MODULE</span><span class="token operator">=</span>backend.settings.development <span class="token punctuation">\</span>
    celery <span class="token punctuation">\</span>
    --app<span class="token operator">=</span>backend.celery_app:app <span class="token punctuation">\</span>
    beat <span class="token punctuation">\</span>
    --loglevel<span class="token operator">=</span>INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>celery beat v4.4.7 (cliffs) is starting.
__    -    ... __   -        _
LocalTime -&gt; 2021-03-06 23:53:35
Configuration -&gt;
    . broker -&gt; redis://localhost:6379/1
    . loader -&gt; celery.loaders.app.AppLoader
    . scheduler -&gt; celery.beat.PersistentScheduler
    . db -&gt; celerybeat-schedule
    . logfile -&gt; [stderr]@%INFO
    . maxinterval -&gt; 5.00 minutes (300s)
[2021-03-06 23:53:35,922: INFO/MainProcess] beat: Starting...
[2021-03-06 23:53:45,934: INFO/MainProcess] Scheduler: Sending due task celery-beat-debug-task (apps.core.tasks.celery_beat_debug_task)
[2021-03-06 23:53:55,930: INFO/MainProcess] Scheduler: Sending due task celery-beat-debug-task (apps.core.tasks.celery_beat_debug_task)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Now we should be able to see <code>celery_beat_debug_task</code> tasks processed by the celery worker.</p><p>The only issue is that our celery beat configuration will not be reloaded automatically like celery and the Django development server do. To fix this, we can use <code>watchdog</code>:</p><p>Stop the celery beat process and run the following command from the backend directory:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DJANGO_SETTINGS_MODULE=backend.settings.development \
    watchmedo \
    auto-restart \
    --directory=./ \
    --pattern=*.py \
    --recursive \
    -- \
    celery \
    --app=backend.celery_app:app \
    beat \
    --loglevel=INFO
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Now try changing the celery beat task to be fired every 2 seconds or some other value.</p><h2 id="setup-mailhog-for-testing-email-locally" tabindex="-1"><a class="header-anchor" href="#setup-mailhog-for-testing-email-locally" aria-hidden="true">#</a> Setup mailhog for testing email locally</h2><p>Mailhog is a simple tool that I use when working with email. If your Django application involves sending email from the application, I recommend using Mailhog to preview emails that will be sent from Django.</p><p>Mailhog is written in go, so you will need to do the following to use it locally:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo apt-get -y install golang-go
go get github.com/mailhog/MailHog
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Once it has finished installing, run the following command to start Mailhog:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>~/go/bin/MailHog
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then you can see Mailhog in the browser by going to <code>http://localhost:8025/</code>.</p><p>We can write a simple task that will send an email, but we first need to tell Django what to use to send email, so we can add the following lines to <code>base.py</code></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Email</span>
EMAIL_HOST <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;DJANGO_EMAIL_HOST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span>
EMAIL_PORT <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;DJANGO_EMAIL_PORT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1025&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>It is generally a good idea to send email from celery, so let&#39;s create an <code>email_debug_task</code> task in <code>apps/core/tasks.py</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_email_debug_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    email <span class="token operator">=</span> EmailMessage<span class="token punctuation">(</span>
        <span class="token string">&quot;Django Step-by-step&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;This email was sent from Celery.&quot;</span><span class="token punctuation">,</span>
        settings<span class="token punctuation">.</span>DEFAULT_FROM_EMAIL<span class="token punctuation">,</span>
        <span class="token punctuation">[</span>settings<span class="token punctuation">.</span>ADMIN_EMAIL<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    email<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Now we can call this task from Jupyter notebook:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> time
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>core<span class="token punctuation">.</span>tasks <span class="token keyword">import</span> send_email_debug_task

send_email_debug_task<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>We should now see the email in Mailhog.</p><h2 id="build-a-model-that-we-can-use-to-demonstrate-crud-and-other-concepts" tabindex="-1"><a class="header-anchor" href="#build-a-model-that-we-can-use-to-demonstrate-crud-and-other-concepts" aria-hidden="true">#</a> Build a Model that we can use to demonstrate CRUD and other concepts</h2><p>Now we can turn to our Django application and setup a model that we can use for demonstration purposes. We will use this model to demonstrate some of the following patterns that are often used in Django projects.</p><ul><li>More complex data relationships</li><li>Templates</li><li>Views</li><li>Forms</li><li>Media files</li><li>DRF, Serializers</li><li>Web sockets</li><li>Testing patterns with pytest and factory</li></ul><p>Let&#39;s suppose we are developing a microblogging application and we want to allow users to create posts. Our post model will contain a text field with a limited number of characters and will optionally allow users to upload media files such as images and gifs.</p><p>Before we build the model, we should build a new Django app that will contain the majority of the logic for our application.</p><h2 id="create-a-new-django-app-for-our-microblogging-demo-application" tabindex="-1"><a class="header-anchor" href="#create-a-new-django-app-for-our-microblogging-demo-application" aria-hidden="true">#</a> Create a new Django app for our microblogging demo application</h2><p>Again, the typical way to add an app to a Django application would be the following command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django-admin startapp blog
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>We want to create the app in the <code>apps</code> directory that we have created in the root of our Django project (the <code>apps</code> directory is located in the same directory as <code>manage.py</code>)</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir -p backend/apps/blog &amp;&amp; django-admin startapp blog ./backend/apps/blog
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Make sure to add <code>apps.blog</code> to the <code>INSTALLED_APPS</code> in <code>base.py</code>.</p><h2 id="add-the-model-for-our-microblogs-posts" tabindex="-1"><a class="header-anchor" href="#add-the-model-for-our-microblogs-posts" aria-hidden="true">#</a> Add the model for our microblogs posts</h2><p>Next we can add a post model to the <code>blog</code> app that was created.</p><p>Let&#39;s consider both a simple version of our post model, and a more complex model.</p><p>For a simple model, we can do something like this:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># simple Post model</span>
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>core<span class="token punctuation">.</span>models <span class="token keyword">import</span> BaseModel


<span class="token keyword">class</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    body <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>A more complicated model might include some of the features you would see on a site like Twitter:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># a more complex Post model</span>
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>core<span class="token punctuation">.</span>models <span class="token keyword">import</span> BaseModel


VISIBILITY_OPTIONS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;Public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Private&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Visible to Friends&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
    text <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    visibility <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>options<span class="token operator">=</span>VISIBILITY_OPTIONS<span class="token punctuation">)</span>
    likes <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>through<span class="token operator">=</span>PostLike<span class="token punctuation">)</span>
    hashtags <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>Hashtag<span class="token punctuation">)</span>
    mentions <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    repost <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">&#39;self&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>We can start wit a simple model for now, and then explore adding additional features of a more complex model later.</p><p>The simple model will have the <code>body</code> field and the four fields from the <code>BaseModel</code> that it inherits from: <code>created_on</code>, <code>modified_on</code>, <code>created_by</code> and <code>modified_by</code>. It doesn&#39;t really make sense to have the <code>modified_by</code> attribute on the <code>Post</code> model since only the creator of a post will be able to edit that post. We could either include it, or we can set the <code>modified_by</code> attribute to <code>None</code> on our <code>Post</code> model.</p><h2 id="run-makemigrations" tabindex="-1"><a class="header-anchor" href="#run-makemigrations" aria-hidden="true">#</a> Run <code>makemigrations</code></h2><p>Next run the <code>makemigrations</code> command:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ python3 backend/manage.py makemigrations
Migrations for &#39;blog&#39;:
  apps/blog/migrations/0001_initial.py
    - Create model Post
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Check out the <code>0001_initial.py</code> file that was generated and we can see the fields that will be created for our <code>Post</code> model (when we run the <code>migrate</code> command):</p><ul><li><code>id</code></li><li><code>created_on</code></li><li><code>modified_on</code></li><li><code>body</code></li><li><code>created_by</code></li></ul><h2 id="run-the-migrate-command" tabindex="-1"><a class="header-anchor" href="#run-the-migrate-command" aria-hidden="true">#</a> Run the <code>migrate</code> command</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ python3 backend/manage.py migrate
Operations to perform:
  Apply all migrations: accounts, admin, auth, blog, contenttypes, core, sessions
Running migrations:
  Applying blog.0001_initial... OK
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="register-the-post-model-to-the-django-admin" tabindex="-1"><a class="header-anchor" href="#register-the-post-model-to-the-django-admin" aria-hidden="true">#</a> Register the <code>Post</code> model to the Django admin</h2><p>The first thing I usually do after creating or changing a model is to register that model to the Django admin. To do this, we can add a few lines of code to the <code>admin.py</code> file in our <code>blog</code> app:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/blog/admin.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin

<span class="token comment"># Register your models here.</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Post

admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span>Post<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>This gives us an interface that we can use to start doing CRUD with our new model. This is one of the big selling points of Django! It is possible to make changes to the behavior of the admin, but you are generally supposed to use this for only admin purposes, not for anything that is face non-technical end users of your application.</p><p>Click on the <code>Posts</code> model, and add a Post with the <code>Add Post</code> button. You will then see our post:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Post object (1)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-str-method-to-our-model" tabindex="-1"><a class="header-anchor" href="#add-a-str-method-to-our-model" aria-hidden="true">#</a> Add a __str__ method to our model</h2><p>It would be better if we could see a preview of the post text. We can implement this by adding a <code>__str__</code> method to our <code>Post</code> model:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>    def __str__(self):
        return self.body
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="add-model-factories-for-micro-blog-post" tabindex="-1"><a class="header-anchor" href="#add-model-factories-for-micro-blog-post" aria-hidden="true">#</a> Add model factories for micro blog post</h2><p>Now that we have a basic working model, we can start adding some tools that will help us test our application&#39;s logic. I have had good experiences using <code>factory</code>.</p><p>Add factory to the <code>test.txt</code> dependencies file:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>factory-boy==3.2.0
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Install the dependencies again with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pip3 install -r backend/requirements/test.txt
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="setup-a-factory-py-file-in-the-blog-app-with-a-postfactory" tabindex="-1"><a class="header-anchor" href="#setup-a-factory-py-file-in-the-blog-app-with-a-postfactory" aria-hidden="true">#</a> Setup a <code>factory.py</code> file in the blog app with a <code>PostFactory</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> get_user_model
<span class="token keyword">from</span> factory<span class="token punctuation">.</span>django <span class="token keyword">import</span> DjangoModelFactory

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post

User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">UserFactory</span><span class="token punctuation">(</span>DjangoModelFactory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User


<span class="token comment"># Another, different, factory for the same object</span>
<span class="token keyword">class</span> <span class="token class-name">PostFactory</span><span class="token punctuation">(</span>DjangoModelFactory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Post
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="create-a-simple-test-using-postfactory" tabindex="-1"><a class="header-anchor" href="#create-a-simple-test-using-postfactory" aria-hidden="true">#</a> Create a simple test using <code>PostFactory</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pytest

<span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> TestCase
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>factory <span class="token keyword">import</span> PostFactory
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post


<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>django_db</span><span class="token punctuation">(</span>transaction<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    POST_TEXT <span class="token operator">=</span> <span class="token string">&quot;This is a test post.&quot;</span>

    <span class="token comment"># this saves the post in the database</span>
    post <span class="token operator">=</span> PostFactory<span class="token punctuation">(</span>body<span class="token operator">=</span>POST_TEXT<span class="token punctuation">)</span>

    <span class="token comment"># this queries the database for the number of posts</span>
    post_count <span class="token operator">=</span> Post<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># checks to see if the number of posts queried is 1</span>
    <span class="token keyword">assert</span> post_count <span class="token operator">==</span> <span class="token number">1</span>

    <span class="token comment"># checks that the post has the body that we assigned to it in the test</span>
    <span class="token keyword">assert</span> post<span class="token punctuation">.</span>body <span class="token operator">==</span> POST_TEXT
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>This is typically not the type of test we want to write, but this does help to make sure that everything is setup correctly. The problem with this test is that it doesn&#39;t test any of the logic in our application. Later on we will write some tests that do test specific parts of our application logic.</p><h2 id="create-a-url-pattern-that-will-list-all-of-the-blog-posts" tabindex="-1"><a class="header-anchor" href="#create-a-url-pattern-that-will-list-all-of-the-blog-posts" aria-hidden="true">#</a> Create a URL pattern that will list all of the blog posts</h2><p>Create <code>apps/blog/urls.py</code> with the following code:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&quot;posts/&quot;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>posts<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="include-the-urls-you-just-created-in-the-main-urls-file" tabindex="-1"><a class="header-anchor" href="#include-the-urls-you-just-created-in-the-main-urls-file" aria-hidden="true">#</a> Include the URLs you just created in the main URLs file</h2><p>Django uses the <code>backend/urls.py</code> to find URLs in our application. Even though we defined a <code>urls.py</code> file in our <code>blog</code> app, Django doesn&#39;t know about it. In order to let Django know about these URLs, add the following line of code to <code>backend/urls.py</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">&quot;apps.blog.urls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># &lt;-- add this line</span>
    path<span class="token punctuation">(</span><span class="token string">&quot;my-admin-portal/&quot;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="create-a-simple-function-based-view-for-viewing-all-posts" tabindex="-1"><a class="header-anchor" href="#create-a-simple-function-based-view-for-viewing-all-posts" aria-hidden="true">#</a> Create a simple function-based view for viewing all posts</h2><p>In <code>apps/blog/views.py</code> add a <code>posts</code> function:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post


<span class="token keyword">def</span> <span class="token function">posts</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    context <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;posts&quot;</span><span class="token punctuation">:</span> Post<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> template_name<span class="token operator">=</span><span class="token string">&quot;posts.html&quot;</span><span class="token punctuation">,</span> context<span class="token operator">=</span>context<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="create-a-templates-directory-in-the-blog-app-and-add-posts-html" tabindex="-1"><a class="header-anchor" href="#create-a-templates-directory-in-the-blog-app-and-add-posts-html" aria-hidden="true">#</a> Create a <code>templates</code> directory in the <code>blog</code> app and add <code>posts.html</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{% extends &quot;base.html&quot; %}

This is the post template
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="add-dirs-base-dir-templates-to-settings-base-py" tabindex="-1"><a class="header-anchor" href="#add-dirs-base-dir-templates-to-settings-base-py" aria-hidden="true">#</a> Add <code>&quot;DIRS&quot;: [BASE_DIR / &quot;templates&quot;],</code> to <code>settings/base.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;BACKEND&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;django.template.backends.django.DjangoTemplates&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;DIRS&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>BASE_DIR <span class="token operator">/</span> <span class="token string">&quot;templates&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># &lt;-- this line</span>
        <span class="token string">&quot;APP_DIRS&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token string">&quot;OPTIONS&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;context_processors&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;django.template.context_processors.debug&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;django.template.context_processors.request&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;django.contrib.auth.context_processors.auth&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;django.contrib.messages.context_processors.messages&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="add-a-new-folder-in-the-backend-directory-called-templates-and-add-base-html" tabindex="-1"><a class="header-anchor" href="#add-a-new-folder-in-the-backend-directory-called-templates-and-add-base-html" aria-hidden="true">#</a> Add a new folder in the <code>backend</code> directory called <code>templates</code> and add <code>base.html</code></h2><p>We are now going to implement template inheritance (<a href="https://docs.djangoproject.com/en/3.1/ref/templates/language/#template-inheritance" target="_blank" rel="noopener noreferrer">https://docs.djangoproject.com/en/3.1/ref/templates/language/#template-inheritance<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>)</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>This is the base template
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-bootstrap-to-our-base-template" tabindex="-1"><a class="header-anchor" href="#add-bootstrap-to-our-base-template" aria-hidden="true">#</a> Add Bootstrap to our base template</h2><h2 id="write-a-management-command-that-generates-fake-data" tabindex="-1"><a class="header-anchor" href="#write-a-management-command-that-generates-fake-data" aria-hidden="true">#</a> Write a management command that generates fake data</h2><p>To test out our template logic, we can generate some posts. We can use the <code>faker</code> library to do this along with a Django management command.</p><p>Create the following file in <code>apps/blog/management/commands/generate_posts.py</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>management<span class="token punctuation">.</span>base <span class="token keyword">import</span> BaseCommand

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>factory <span class="token keyword">import</span> PostFactory


<span class="token keyword">class</span> <span class="token class-name">Command</span><span class="token punctuation">(</span>BaseCommand<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">help</span> <span class="token operator">=</span> <span class="token string">&quot;Generate some posts&quot;</span>

    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>options<span class="token punctuation">)</span><span class="token punctuation">:</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;generating posts&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            PostFactory<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;finished generating posts&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="add-pagination-to-posts-view" tabindex="-1"><a class="header-anchor" href="#add-pagination-to-posts-view" aria-hidden="true">#</a> Add pagination to posts view</h2><p>We should add pagination so we can limit the number of posts that are shown.</p><p><a href="https://docs.djangoproject.com/en/3.1/topics/pagination/#using-paginator-in-a-view-function" target="_blank" rel="noopener noreferrer">https://docs.djangoproject.com/en/3.1/topics/pagination/#using-paginator-in-a-view-function<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>paginator <span class="token keyword">import</span> Paginator
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="create-a-post-detail-view" tabindex="-1"><a class="header-anchor" href="#create-a-post-detail-view" aria-hidden="true">#</a> Create a post detail view</h2><h2 id="add-url-for-post-detail-view" tabindex="-1"><a class="header-anchor" href="#add-url-for-post-detail-view" aria-hidden="true">#</a> Add URL for post detail view</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    <span class="token comment"># read (detail)</span>
    path<span class="token punctuation">(</span><span class="token string">&quot;posts/&lt;str:id&gt;&quot;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>post<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="create-a-template-called-post-html-in-templates" tabindex="-1"><a class="header-anchor" href="#create-a-template-called-post-html-in-templates" aria-hidden="true">#</a> Create a template called <code>post.html</code> in templates</h2><h2 id="link-to-detail-views-from-the-list-view" tabindex="-1"><a class="header-anchor" href="#link-to-detail-views-from-the-list-view" aria-hidden="true">#</a> Link to detail views from the list view</h2><h2 id="set-up-head-for-post-detail-page-for-seo" tabindex="-1"><a class="header-anchor" href="#set-up-head-for-post-detail-page-for-seo" aria-hidden="true">#</a> Set up <code>head</code> for Post detail page for SEO</h2><h2 id="add-post-create-form" tabindex="-1"><a class="header-anchor" href="#add-post-create-form" aria-hidden="true">#</a> Add Post Create Form</h2><p>We can generate posts through the admin and through our management command. Now let&#39;s add a way for users to add posts.</p><h2 id="add-a-url-for-a-creating-a-new-post" tabindex="-1"><a class="header-anchor" href="#add-a-url-for-a-creating-a-new-post" aria-hidden="true">#</a> Add a URL for a creating a new post</h2><h2 id="add-new-post-html-template" tabindex="-1"><a class="header-anchor" href="#add-new-post-html-template" aria-hidden="true">#</a> Add <code>new_post.html</code> template</h2><h2 id="change-the-ordering-of-posts-in-the-post-model" tabindex="-1"><a class="header-anchor" href="#change-the-ordering-of-posts-in-the-post-model" aria-hidden="true">#</a> Change the ordering of posts in the Post model</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Post</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># meta class</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        ordering <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;-created_on&quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="add-wildcard-to-allowed-hosts-in-development-settings-module" tabindex="-1"><a class="header-anchor" href="#add-wildcard-to-allowed-hosts-in-development-settings-module" aria-hidden="true">#</a> Add wildcard to <code>ALLOWED_HOSTS</code> in <code>development</code> settings module</h2><p>This will allow you to view the application from a mobile device on your local network</p><h2 id="use-django-messaging-framework-to-update-user-on-post-creation-success" tabindex="-1"><a class="header-anchor" href="#use-django-messaging-framework-to-update-user-on-post-creation-success" aria-hidden="true">#</a> Use Django messaging framework to update user on post creation success</h2><h2 id="create-urls-py-in-the-accounts-app-with-a-login-path" tabindex="-1"><a class="header-anchor" href="#create-urls-py-in-the-accounts-app-with-a-login-path" aria-hidden="true">#</a> Create <code>urls.py</code> in the accounts app with a login path</h2><h2 id="create-the-login-view-in-apps-accounts-views" tabindex="-1"><a class="header-anchor" href="#create-the-login-view-in-apps-accounts-views" aria-hidden="true">#</a> Create the login view in <code>apps/accounts/views</code></h2><h2 id="override-the-default-login-form" tabindex="-1"><a class="header-anchor" href="#override-the-default-login-form" aria-hidden="true">#</a> Override the Default Login form</h2><p><a href="https://stackoverflow.com/questions/55369645/how-to-customize-default-auth-login-form-in-django/55369791" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/55369645/how-to-customize-default-auth-login-form-in-django/55369791<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="set-login-redirect-url-and-login-redirect-url-in-base-settings-module" tabindex="-1"><a class="header-anchor" href="#set-login-redirect-url-and-login-redirect-url-in-base-settings-module" aria-hidden="true">#</a> Set <code>LOGIN_REDIRECT_URL</code> and <code>LOGIN_REDIRECT_URL</code> in <code>base</code> settings module</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>LOGIN_REDIRECT_URL <span class="token operator">=</span> <span class="token string">&quot;/posts&quot;</span>
LOGOUT_REDIRECT_URL <span class="token operator">=</span> <span class="token string">&quot;/posts&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="create-login-page" tabindex="-1"><a class="header-anchor" href="#create-login-page" aria-hidden="true">#</a> Create Login page</h2><h2 id="enable-logout" tabindex="-1"><a class="header-anchor" href="#enable-logout" aria-hidden="true">#</a> Enable logout</h2><h2 id="create-update-view-for-post" tabindex="-1"><a class="header-anchor" href="#create-update-view-for-post" aria-hidden="true">#</a> Create update view for post</h2><h2 id="create-update-url-for-post" tabindex="-1"><a class="header-anchor" href="#create-update-url-for-post" aria-hidden="true">#</a> Create update URL for post</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-delete-url-path-for-posts" tabindex="-1"><a class="header-anchor" href="#add-delete-url-path-for-posts" aria-hidden="true">#</a> Add delete URL path for posts</h2><h2 id="create-delete-view-for-post" tabindex="-1"><a class="header-anchor" href="#create-delete-view-for-post" aria-hidden="true">#</a> Create delete view for post</h2><h2 id="enable-searching-posts" tabindex="-1"><a class="header-anchor" href="#enable-searching-posts" aria-hidden="true">#</a> Enable searching posts</h2><h2 id="fix-pagination-with-search-term" tabindex="-1"><a class="header-anchor" href="#fix-pagination-with-search-term" aria-hidden="true">#</a> Fix pagination with search term</h2><p>Add the following do each of the links in the pagination section of the post list. This will ensure that the search term query parameter and pagination can be used together.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&amp;q={{ request.GET.q }}{% endif %}<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>previous<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span>
<span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>If there are lots of other parameters to add, use the following solution: <a href="https://stackoverflow.com/questions/2047622/how-to-paginate-django-with-other-get-variables" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/2047622/how-to-paginate-django-with-other-get-variables<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="add-registration-url" tabindex="-1"><a class="header-anchor" href="#add-registration-url" aria-hidden="true">#</a> Add registration URL</h2><h2 id="add-registration-view" tabindex="-1"><a class="header-anchor" href="#add-registration-view" aria-hidden="true">#</a> Add registration view</h2><p>There are a lot of ways to do registration, and lots of packages that can help with this process.</p><p>We can start with a simple implementation that allows us to signup with an email address with a confirmation email. Since we have already setup MailHog, this should be easy.</p><h2 id="add-registration-form" tabindex="-1"><a class="header-anchor" href="#add-registration-form" aria-hidden="true">#</a> Add registration form</h2><h2 id="add-email-confirmation-url-and-view" tabindex="-1"><a class="header-anchor" href="#add-email-confirmation-url-and-view" aria-hidden="true">#</a> Add email confirmation url and view</h2><h2 id="add-request-password-reset-form" tabindex="-1"><a class="header-anchor" href="#add-request-password-reset-form" aria-hidden="true">#</a> Add request Password reset form</h2><h2 id="add-password-reset-email-with-link" tabindex="-1"><a class="header-anchor" href="#add-password-reset-email-with-link" aria-hidden="true">#</a> Add password reset email with link</h2><h2 id="add-password-reset-url" tabindex="-1"><a class="header-anchor" href="#add-password-reset-url" aria-hidden="true">#</a> Add password reset URL</h2><h2 id="add-password-reset-form" tabindex="-1"><a class="header-anchor" href="#add-password-reset-form" aria-hidden="true">#</a> Add password reset form</h2><h2 id="add-password-reset-view" tabindex="-1"><a class="header-anchor" href="#add-password-reset-view" aria-hidden="true">#</a> Add password reset view</h2><h2 id="add-vue-via-cdn-in-base-html" tabindex="-1"><a class="header-anchor" href="#add-vue-via-cdn-in-base-html" aria-hidden="true">#</a> Add Vue via CDN in <code>base.html</code></h2><p><a href="https://v3.vuejs.org/guide/installation.html#cdn" target="_blank" rel="noopener noreferrer">https://v3.vuejs.org/guide/installation.html#cdn<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/vue@next<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-an-example-of-how-to-setup-a-vue-component-in-django-template" tabindex="-1"><a class="header-anchor" href="#add-an-example-of-how-to-setup-a-vue-component-in-django-template" aria-hidden="true">#</a> Add an example of how to setup a Vue component in Django template</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>{% for post in page_obj %}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/posts/{{ post.id }}<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> #000</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>card p-4 mb-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ post.body }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ post.created_on }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    {% if post.created_by %}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ post.created_by }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    {% endif %} {% include &quot;post_likes.html&quot; with post_id=post.id
    like_count=post.like_count liked=post.liked %}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
{% endfor %}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Notice the <code>{% include &quot;post_likes.html&quot; ... %}</code>, will add a nested template with different parameters to our page that will contain a clickable heart button that will make an API call to the backend.</p><h2 id="create-a-template-called-post-likes-html" tabindex="-1"><a class="header-anchor" href="#create-a-template-called-post-likes-html" aria-hidden="true">#</a> Create a template called <code>post_likes.html</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>backend/apps/blog/templates/post_likes.html
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-vue-component-definition-and-template" tabindex="-1"><a class="header-anchor" href="#add-vue-component-definition-and-template" aria-hidden="true">#</a> Add Vue component definition and template</h2><p>Notice how the Javascript <code>const</code> definition for the Vue component contains a Django template variable. We need to do this so the name of each created Vue component is unique.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> LikeCounter<span class="token punctuation">{</span><span class="token punctuation">{</span> post_id <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  delimiters<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;[[&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;]]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> like_count <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      liked<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> liked <span class="token operator">|</span> lower <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span>LikeCounter<span class="token punctuation">{</span><span class="token punctuation">{</span> post_id <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#counter-{{ post_id }}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="add-axios-via-cdn" tabindex="-1"><a class="header-anchor" href="#add-axios-via-cdn" aria-hidden="true">#</a> Add axios Via CDN</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- Axios --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="configure-axios-cdn" tabindex="-1"><a class="header-anchor" href="#configure-axios-cdn" aria-hidden="true">#</a> Configure Axios CDN</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- configure axios to use csrftoken --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>xsrfCookieName <span class="token operator">=</span> <span class="token string">&quot;csrftoken&quot;</span><span class="token punctuation">;</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>xsrfHeaderName <span class="token operator">=</span> <span class="token string">&quot;X-CSRFTOKEN&quot;</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="add-a-method-to-the-postlike-component-that-will-make-an-api-call-using-axios" tabindex="-1"><a class="header-anchor" href="#add-a-method-to-the-postlike-component-that-will-make-an-api-call-using-axios" aria-hidden="true">#</a> Add a method to the PostLike component that will make an API call using axios</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">toggleLike</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/posts/{{ post_id }}/like&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>counter <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">.</span>likes<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>liked <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">.</span>like<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Please login or create an account to like posts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="setup-an-endpoint-that-will-handle-our-axios-call" tabindex="-1"><a class="header-anchor" href="#setup-an-endpoint-that-will-handle-our-axios-call" aria-hidden="true">#</a> Setup an endpoint that will handle our axios call</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    path<span class="token punctuation">(</span><span class="token string">&quot;api/posts/&lt;str:id&gt;/like&quot;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>like_post<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;like-post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="setup-a-view-to-handle-the-like-post-endpoint-that-returns-a-jsonresponse" tabindex="-1"><a class="header-anchor" href="#setup-a-view-to-handle-the-like-post-endpoint-that-returns-a-jsonresponse" aria-hidden="true">#</a> Setup a view to handle the like-post endpoint that returns a JsonResponse</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> login_required
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>decorators<span class="token punctuation">.</span>http <span class="token keyword">import</span> require_POST


<span class="token decorator annotation punctuation">@login_required</span>
<span class="token decorator annotation punctuation">@require_POST</span>
<span class="token keyword">def</span> <span class="token function">like_post</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># implement like post logic</span>
    post <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>Post<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>user <span class="token keyword">not</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>likes<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        post_like_through_model <span class="token operator">=</span> PostLike<span class="token punctuation">(</span>post<span class="token operator">=</span>post<span class="token punctuation">,</span> liked_by<span class="token operator">=</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        post_like_through_model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        like <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        post<span class="token punctuation">.</span>likes<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        like <span class="token operator">=</span> <span class="token boolean">False</span>

    post_like_count <span class="token operator">=</span> post<span class="token punctuation">.</span>likes<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;likes&quot;</span><span class="token punctuation">:</span> post_like_count<span class="token punctuation">,</span> <span class="token string">&quot;like&quot;</span><span class="token punctuation">:</span> like<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="implement-through-model-for-manytomany-field-for-post-likes" tabindex="-1"><a class="header-anchor" href="#implement-through-model-for-manytomany-field-for-post-likes" aria-hidden="true">#</a> Implement through Model for ManyToMany field for Post likes</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># apps/blog/models.py</span>
<span class="token keyword">class</span> <span class="token class-name">PostLike</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    liked_by <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>User<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    post <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Post<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="add-through-model-to-django-admin" tabindex="-1"><a class="header-anchor" href="#add-through-model-to-django-admin" aria-hidden="true">#</a> Add through model to Django admin</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span>PostLike<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="run-makemigrations-and-migrate-for-postlike" tabindex="-1"><a class="header-anchor" href="#run-makemigrations-and-migrate-for-postlike" aria-hidden="true">#</a> Run <code>makemigrations</code> and <code>migrate</code> for PostLike</h2><h2 id="add-prefetch-related-created-by-to-post-list-query-to-reduce-db-queries" tabindex="-1"><a class="header-anchor" href="#add-prefetch-related-created-by-to-post-list-query-to-reduce-db-queries" aria-hidden="true">#</a> Add <code>prefetch_related(&quot;created_by&quot;)</code> to post list query to reduce DB queries</h2><h2 id="add-a-favicon-in-static" tabindex="-1"><a class="header-anchor" href="#add-a-favicon-in-static" aria-hidden="true">#</a> Add a favicon in static</h2><p>Add <code>favicon.ico</code> to the <code>static</code> folder.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shortcut icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{% static <span class="token punctuation">&#39;</span>favicon.ico<span class="token punctuation">&#39;</span> %}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-github-workflows-lint-yml-for-github-action-that-lints-python-code" tabindex="-1"><a class="header-anchor" href="#add-github-workflows-lint-yml-for-github-action-that-lints-python-code" aria-hidden="true">#</a> Add <code>.github/workflows/lint.yml</code> for GitHub Action that lints Python code</h2><p>Let&#39;s add a GitHub action following this example.</p><p><a href="https://docs.github.com/en/actions/quickstart" target="_blank" rel="noopener noreferrer">https://docs.github.com/en/actions/quickstart<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> lint<span class="token punctuation">-</span>and<span class="token punctuation">-</span>test<span class="token punctuation">-</span>python

<span class="token comment"># Run this workflow every time a new commit pushed to your repository</span>
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> main

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token comment"># Set the job key. The key is displayed as the job name</span>
  <span class="token comment"># when a job name is not provided</span>
  <span class="token key atrule">lint-and-test-python</span><span class="token punctuation">:</span>
    <span class="token comment"># Name the Job</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Lint and test python code
    <span class="token comment"># Set the type of machine to run on</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest

    <span class="token comment"># Service containers to run with `container-job`</span>
    <span class="token key atrule">services</span><span class="token punctuation">:</span>
      <span class="token comment"># Label used to access the service container</span>
      <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
        <span class="token comment"># Docker Hub image</span>
        <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres
        <span class="token comment"># Provide the password for postgres</span>
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> postgres
        <span class="token comment"># Set health checks to wait until postgres has started</span>
        <span class="token key atrule">options</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token punctuation">-</span>
          <span class="token punctuation">-</span><span class="token punctuation">-</span>health<span class="token punctuation">-</span>cmd pg_isready
          <span class="token punctuation">-</span><span class="token punctuation">-</span>health<span class="token punctuation">-</span>interval 10s
          <span class="token punctuation">-</span><span class="token punctuation">-</span>health<span class="token punctuation">-</span>timeout 5s
          <span class="token punctuation">-</span><span class="token punctuation">-</span>health<span class="token punctuation">-</span>retries 5

        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
          <span class="token comment"># Maps tcp port 5432 on service container to the host</span>
          <span class="token punctuation">-</span> 5432<span class="token punctuation">:</span><span class="token number">5432</span>

    <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
        <span class="token key atrule">python-version</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3.8</span><span class="token punctuation">]</span>

    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token comment"># Setup python version</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Python $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.python<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>python@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">python-version</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.python<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token comment"># Checks out a copy of your repository on the ubuntu-latest machine</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3

      <span class="token comment"># install pip dependencies</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pip install
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          python -m pip install --upgrade pip
          pip install -r backend/requirements/base.txt
          pip install -r backend/requirements/dev.txt
          pip install -r backend/requirements/test.txt</span>

      <span class="token comment"># lint python code using flake8</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Lint code
        <span class="token key atrule">run</span><span class="token punctuation">:</span> flake8 backend

      <span class="token comment"># run pytest tests</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run pytest tests
        <span class="token key atrule">run</span><span class="token punctuation">:</span> pytest backend
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h2 id="add-bitbucket-pipelines-yml-for-bitbucket-pipelines" tabindex="-1"><a class="header-anchor" href="#add-bitbucket-pipelines-yml-for-bitbucket-pipelines" aria-hidden="true">#</a> Add <code>bitbucket-pipelines.yml</code> for BitBucket pipelines</h2><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> python<span class="token punctuation">:</span><span class="token number">3.8</span>

<span class="token key atrule">pipelines</span><span class="token punctuation">:</span>
  <span class="token key atrule">default</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">step</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> lint and test python code
        <span class="token key atrule">caches</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> pip
        <span class="token key atrule">script</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> pip install <span class="token punctuation">-</span>r backend/requirements_dev.txt
          <span class="token punctuation">-</span> flake8 backend
          <span class="token punctuation">-</span> black <span class="token punctuation">-</span>l 79 backend
          <span class="token punctuation">-</span> pytest backend
        <span class="token key atrule">services</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> postgres

<span class="token key atrule">definitions</span><span class="token punctuation">:</span>
  <span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
      <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres
      <span class="token key atrule">variables</span><span class="token punctuation">:</span>
        <span class="token key atrule">POSTGRES_DB</span><span class="token punctuation">:</span> <span class="token string">&quot;postgres&quot;</span>
        <span class="token key atrule">POSTGRES_USER</span><span class="token punctuation">:</span> <span class="token string">&quot;postgres&quot;</span>
        <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">&quot;postgres&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="generic-class-based-views" tabindex="-1"><a class="header-anchor" href="#generic-class-based-views" aria-hidden="true">#</a> Generic Class Based Views</h2><p>We can reimplement our application logic with generic class-based views (GCBVs). There&#39;s nothing wrong without function-based views (FBVs). The code is straightforward and relatively easy to understand. GCBVs will let us achieve the same functionality with fewer lines of code. You can use only CBVs, only GBVs or a mix of the two together. However you decide to write your view, GCBVs are in import part of Django that you should know about.</p><p>This project demonstrates implementations of FBVs and GCBVs, as well as other ways of expressing our views using the Django REST Framework, which also has a similar concept of FBVs and GCBVs.</p><h2 id="create-a-file-in-the-blog-app-called-class-based-views-py" tabindex="-1"><a class="header-anchor" href="#create-a-file-in-the-blog-app-called-class-based-views-py" aria-hidden="true">#</a> Create a file in the <code>blog</code> app called <code>class_based_views.py</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>touch backend/apps/blog/class_based_views.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-generic-listview-to-the-class-based-views-file" tabindex="-1"><a class="header-anchor" href="#add-a-generic-listview-to-the-class-based-views-file" aria-hidden="true">#</a> Add a generic <code>ListView</code> to the <code>class_based_views</code> file</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># class_based_views.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>generic <span class="token keyword">import</span> ListView
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post


<span class="token keyword">class</span> <span class="token class-name">PostList</span><span class="token punctuation">(</span>ListView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> Post
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Note</strong>: the name of the file <code>cbv_urls.py</code> doesn&#39;t matter.</p><h2 id="setup-a-new-urls-file" tabindex="-1"><a class="header-anchor" href="#setup-a-new-urls-file" aria-hidden="true">#</a> Setup a new URLs file</h2><p>Let&#39;s add a new URLs file to the <code>blog</code> app that will contain urls for our GCBVs.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>touch backend/apps/blog/cbv_urls.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-urlpatterns-with-a-path-that-uses-the-postlist-cbv" tabindex="-1"><a class="header-anchor" href="#add-a-urlpatterns-with-a-path-that-uses-the-postlist-cbv" aria-hidden="true">#</a> Add a <code>urlpatterns</code> with a path that uses the <code>PostList</code> CBV</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># URLs for GCBVs</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>class_based_views <span class="token keyword">import</span> PostList

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">&quot;posts&quot;</span><span class="token punctuation">,</span> PostList<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="include-cbv-urls-py-in-backend-urls-py" tabindex="-1"><a class="header-anchor" href="#include-cbv-urls-py-in-backend-urls-py" aria-hidden="true">#</a> Include <code>cbv_urls.py</code> in <code>backend/urls.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    path<span class="token punctuation">(</span><span class="token string">&quot;cbv/&quot;</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">&quot;apps.blog.cbv_urls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Now visit <code>http://127.0.0.1:8000/cbv/posts</code> and we will see the following error:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>django.template.exceptions.TemplateDoesNotExist
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="fix-the-template-for-the-postlist-cbv" tabindex="-1"><a class="header-anchor" href="#fix-the-template-for-the-postlist-cbv" aria-hidden="true">#</a> Fix the template for the PostList CBV</h2><p>Class based-views expect to find a template at <code>blog/post_list.html</code> in our app&#39;s <code>templates</code> directory. We can put a template there, or we can override the location by adding <code>template_name</code> to <code>PostList</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">PostList</span><span class="token punctuation">(</span>ListView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> Post
    template_name <span class="token operator">=</span> <span class="token string">&quot;blog/posts.html&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="add-cbv-detailview-for-viewing-a-single-post" tabindex="-1"><a class="header-anchor" href="#add-cbv-detailview-for-viewing-a-single-post" aria-hidden="true">#</a> Add CBV DetailView for viewing a single post</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">PostDetailView</span><span class="token punctuation">(</span>DetailView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> Post
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="add-url-path-for-detailview" tabindex="-1"><a class="header-anchor" href="#add-url-path-for-detailview" aria-hidden="true">#</a> Add URL path for DetailView</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    path<span class="token punctuation">(</span><span class="token string">&quot;posts/&lt;int:pk&gt;&quot;</span><span class="token punctuation">,</span> PostDetailView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-template-for-the-postdetailview-in-blog-post-detail-in-the-blog-app-templates-directory" tabindex="-1"><a class="header-anchor" href="#add-a-template-for-the-postdetailview-in-blog-post-detail-in-the-blog-app-templates-directory" aria-hidden="true">#</a> Add a template for the PostDetailView in <code>blog/post_detail</code> in the <code>blog</code> app <code>templates</code> directory</h2><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-a-postcreateview-for-creating-posts-using-cbv" tabindex="-1"><a class="header-anchor" href="#add-a-postcreateview-for-creating-posts-using-cbv" aria-hidden="true">#</a> Add a PostCreateView for creating posts using CBV</h2><h2 id="add-a-postupdateview-for-editing-posts" tabindex="-1"><a class="header-anchor" href="#add-a-postupdateview-for-editing-posts" aria-hidden="true">#</a> Add a PostUpdateView for editing posts</h2><ul><li>template</li><li>URL pattern</li><li>CBV</li><li>tests</li></ul><h2 id="add-a-deletepostview-for-deleting-posts" tabindex="-1"><a class="header-anchor" href="#add-a-deletepostview-for-deleting-posts" aria-hidden="true">#</a> Add a DeletePostView for deleting posts</h2><h2 id="add-tests-for-cbvs" tabindex="-1"><a class="header-anchor" href="#add-tests-for-cbvs" aria-hidden="true">#</a> Add tests for CBVs</h2><h2 id="account-management" tabindex="-1"><a class="header-anchor" href="#account-management" aria-hidden="true">#</a> Account Management</h2><h2 id="add-profile-view" tabindex="-1"><a class="header-anchor" href="#add-profile-view" aria-hidden="true">#</a> Add profile view</h2><ul><li>All posts</li><li>Likes</li><li>Post likes</li><li>tests</li></ul><h2 id="add-account-settings-view" tabindex="-1"><a class="header-anchor" href="#add-account-settings-view" aria-hidden="true">#</a> Add account settings view</h2><ul><li>Delete account</li><li>Change password</li></ul><h2 id="refactor-queryset-and-manager-for-post-model" tabindex="-1"><a class="header-anchor" href="#refactor-queryset-and-manager-for-post-model" aria-hidden="true">#</a> Refactor QuerySet and Manager for Post model</h2><h2 id="account-settings" tabindex="-1"><a class="header-anchor" href="#account-settings" aria-hidden="true">#</a> Account settings</h2><h2 id="django-rest-framework" tabindex="-1"><a class="header-anchor" href="#django-rest-framework" aria-hidden="true">#</a> Django REST Framework</h2><h2 id="add-django-rest-framework-to-base-txt-dependencies" tabindex="-1"><a class="header-anchor" href="#add-django-rest-framework-to-base-txt-dependencies" aria-hidden="true">#</a> Add Django REST Framework to <code>base.txt</code> dependencies</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>djangorestframework==3.12.4
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-restframework-to-installed-apps-in-base-settings-module" tabindex="-1"><a class="header-anchor" href="#add-restframework-to-installed-apps-in-base-settings-module" aria-hidden="true">#</a> Add <code>restframework</code> to <code>INSTALLED_APPS</code> in base settings module</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    <span class="token string">&quot;rest_framework&quot;</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-rest-framework-urls-under-the-if-settings-debug-block-in-backend-urls-py" tabindex="-1"><a class="header-anchor" href="#add-rest-framework-urls-under-the-if-settings-debug-block-in-backend-urls-py" aria-hidden="true">#</a> Add REST Framework URLs under the <code>if settings.DEBUG</code> block in <code>backend/urls.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    urlpatterns <span class="token operator">+=</span> <span class="token punctuation">[</span>path<span class="token punctuation">(</span><span class="token string">&quot;api-auth/&quot;</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">&quot;rest_framework.urls&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-openapi-swaggerui-url-path-in-backend-urls-py" tabindex="-1"><a class="header-anchor" href="#add-openapi-swaggerui-url-path-in-backend-urls-py" aria-hidden="true">#</a> Add OpenAPI/SwaggerUI URL path in <code>backend/urls.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>generic <span class="token keyword">import</span> TemplateView

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span>
        <span class="token string">&quot;api/swagger-ui/&quot;</span><span class="token punctuation">,</span>
        TemplateView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span>
            template_name<span class="token operator">=</span><span class="token string">&quot;swagger-ui.html&quot;</span><span class="token punctuation">,</span> extra_context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;schema_url&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        name<span class="token operator">=</span><span class="token string">&quot;swagger-ui&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="add-the-following-file-to-the-top-level-templates-directory" tabindex="-1"><a class="header-anchor" href="#add-the-following-file-to-the-top-level-templates-directory" aria-hidden="true">#</a> Add the following file to the top-level templates directory</h2><p><strong>templates/swagger-ui.html</strong></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>{% load static %}
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Swagger<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>
      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/css<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>//unpkg.com/swagger-ui-dist@3/swagger-ui.css<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>swagger-ui<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>//unpkg.com/swagger-ui-dist@3/swagger-ui-bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">const</span> ui <span class="token operator">=</span> <span class="token function">SwaggerUIBundle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&quot;{% static &#39;openapi/schema.yml&#39; %}&quot;</span><span class="token punctuation">,</span>
        dom_id<span class="token operator">:</span> <span class="token string">&quot;#swagger-ui&quot;</span><span class="token punctuation">,</span>
        presets<span class="token operator">:</span> <span class="token punctuation">[</span>
          SwaggerUIBundle<span class="token punctuation">.</span>presets<span class="token punctuation">.</span>apis<span class="token punctuation">,</span>
          SwaggerUIBundle<span class="token punctuation">.</span>SwaggerUIStandalonePreset<span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        layout<span class="token operator">:</span> <span class="token string">&quot;BaseLayout&quot;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">requestInterceptor</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;X-CSRFToken&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;{{ csrf_token }}&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> request<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="add-dependencies-for-openapi-to-base-txt" tabindex="-1"><a class="header-anchor" href="#add-dependencies-for-openapi-to-base-txt" aria-hidden="true">#</a> Add dependencies for OpenAPI to base.txt</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># for OpenAPI
uritemplate==3.0.1
coreapi==2.3.3
pyyaml==5.4.1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="create-a-directory-for-the-openapi-schema" tabindex="-1"><a class="header-anchor" href="#create-a-directory-for-the-openapi-schema" aria-hidden="true">#</a> Create a directory for the OpenAPI Schema</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir backend/static/openapi
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="generate-the-openapi-schema" tabindex="-1"><a class="header-anchor" href="#generate-the-openapi-schema" aria-hidden="true">#</a> Generate the OpenAPI schema</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>python3 backend/manage.py generateschema &gt; backend/static/openapi/schema.yml
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Add a <code>make</code> command for this:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">openapi</span><span class="token punctuation">:</span> python3 backend/manage.py generateschema <span class="token punctuation">&gt;</span> backend/static/openapi/schema.yml
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Visit <code>localhost:8000/api/swagger-ui/</code> and we should see an empty OpenAPI/Swagger UI page. As we build an API for our microblog application, this page will be populated.</p><h2 id="add-postserializer-in-serializers-py" tabindex="-1"><a class="header-anchor" href="#add-postserializer-in-serializers-py" aria-hidden="true">#</a> Add <code>PostSerializer</code> in <code>serializers.py</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>touch backend/apps/blog/serializers.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> CustomUserSerializer


<span class="token keyword">class</span> <span class="token class-name">PostSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    liked <span class="token operator">=</span> serializers<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    like_count <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    created_by <span class="token operator">=</span> CustomUserSerializer<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Post
        fields <span class="token operator">=</span> <span class="token punctuation">(</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;created_by&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;modified_on&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;liked&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;like_count&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="add-crud-drf-fbvs-for-blog-app" tabindex="-1"><a class="header-anchor" href="#add-crud-drf-fbvs-for-blog-app" aria-hidden="true">#</a> Add CRUD DRF FBVs for <code>blog</code> app</h2><ul><li>[x] Read (detail)</li><li>[x] Read (list)</li><li>[x] Create</li><li>[x] Update</li><li>[x] Delete</li><li>[x] Tests</li></ul><h2 id="add-crud-drf-cbvs-for-blog-app" tabindex="-1"><a class="header-anchor" href="#add-crud-drf-cbvs-for-blog-app" aria-hidden="true">#</a> Add CRUD DRF CBVs for <code>blog</code> app</h2><ul><li>[x] Use <code>viewsets.ModelViewSet</code></li></ul><h2 id="add-crud-gcbvs-for-blog-app" tabindex="-1"><a class="header-anchor" href="#add-crud-gcbvs-for-blog-app" aria-hidden="true">#</a> Add CRUD GCBVs for <code>blog</code> app??</h2><h2 id="graphql-setup-tasks" tabindex="-1"><a class="header-anchor" href="#graphql-setup-tasks" aria-hidden="true">#</a> GraphQL Setup Tasks</h2><ul><li>Resources</li><li>Install packages</li><li>Configure settings</li><li>JWT Token Auth setup</li><li>PostType</li><li>PostLikeType</li><li>UserType</li><li>AccountType</li><li>PostMutation for creating, updating and deleting</li><li>Query post by ID</li><li>PostLikeMutation for liking a post</li><li>Handle permissions correctly for all mutations</li><li>Pagination</li><li>Filtering</li><li>Sorting</li><li>Relay</li><li>Insomnia Client</li><li>Testing Authentication</li><li>Testing Post queries and mutations (permissions!)</li><li>Pytest and Class Based tests</li><li>Add links in nav UI for GraphiQL</li></ul><h2 id="todo-replace-exceptions-with-graphqlexceptions" tabindex="-1"><a class="header-anchor" href="#todo-replace-exceptions-with-graphqlexceptions" aria-hidden="true">#</a> TODO: replace Exceptions with GraphqlExceptions</h2><h2 id="graphql-resources" tabindex="-1"><a class="header-anchor" href="#graphql-resources" aria-hidden="true">#</a> GraphQL Resources</h2><ul><li><a href="https://graphene-python.org/" target="_blank" rel="noopener noreferrer">https://graphene-python.org/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li><li><a href="https://www.howtographql.com/graphql-python/1-getting-started/" target="_blank" rel="noopener noreferrer">https://www.howtographql.com/graphql-python/1-getting-started/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul><h2 id="add-graphql-dependencies" tabindex="-1"><a class="header-anchor" href="#add-graphql-dependencies" aria-hidden="true">#</a> Add GraphQL dependencies</h2><p>GraphQL is another way to access data in our application. One of the main advantages of GraphQL is that it is easier to request the data that you need from the frontend.</p><p>Here&#39;s a helpful guide that we can use as a reference:</p><p><a href="https://www.howtographql.com/graphql-python/1-getting-started/" target="_blank" rel="noopener noreferrer">https://www.howtographql.com/graphql-python/1-getting-started/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># base.txt

# graphql
graphene-django==2.15.0
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="add-graphene-django-to-installed-apps" tabindex="-1"><a class="header-anchor" href="#add-graphene-django-to-installed-apps" aria-hidden="true">#</a> Add <code>graphene_django</code> to <code>INSTALLED_APPS</code></h2><h2 id="add-graphene-settings-to-base-py" tabindex="-1"><a class="header-anchor" href="#add-graphene-settings-to-base-py" aria-hidden="true">#</a> Add <code>GRAPHENE</code> settings to <code>base.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>GRAPHENE <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;SCHEMA&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;backend.schema.schema&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="add-schema-py-in-the-blog-app-directory" tabindex="-1"><a class="header-anchor" href="#add-schema-py-in-the-blog-app-directory" aria-hidden="true">#</a> Add <code>schema.py</code> in the <code>blog</code> app directory</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> graphene
<span class="token keyword">from</span> graphene_django <span class="token keyword">import</span> DjangoObjectType

<span class="token keyword">from</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>models <span class="token keyword">import</span> Post


<span class="token keyword">class</span> <span class="token class-name">PostType</span><span class="token punctuation">(</span>DjangoObjectType<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Post


<span class="token keyword">class</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>graphene<span class="token punctuation">.</span>ObjectType<span class="token punctuation">)</span><span class="token punctuation">:</span>
    posts <span class="token operator">=</span> graphene<span class="token punctuation">.</span>List<span class="token punctuation">(</span>PostType<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">resolve_posts</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> info<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Post<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="add-a-schema-py-to-the-backend-backend-directory" tabindex="-1"><a class="header-anchor" href="#add-a-schema-py-to-the-backend-backend-directory" aria-hidden="true">#</a> Add a <code>schema.py</code> to the <code>backend/backend</code> directory</h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> graphene

<span class="token keyword">import</span> apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>schema


<span class="token keyword">class</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>apps<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>schema<span class="token punctuation">.</span>Query<span class="token punctuation">,</span> graphene<span class="token punctuation">.</span>ObjectType<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


schema <span class="token operator">=</span> graphene<span class="token punctuation">.</span>Schema<span class="token punctuation">(</span>query<span class="token operator">=</span>Query<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="add-a-graphql-endpoint-to-backend-urls-py" tabindex="-1"><a class="header-anchor" href="#add-a-graphql-endpoint-to-backend-urls-py" aria-hidden="true">#</a> Add a GraphQL endpoint to <code>backend/urls.py</code></h2><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>decorators<span class="token punctuation">.</span>csrf <span class="token keyword">import</span> csrf_exempt
<span class="token keyword">from</span> graphene_django<span class="token punctuation">.</span>views <span class="token keyword">import</span> GraphQLView

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    path<span class="token punctuation">(</span><span class="token string">&#39;graphql/&#39;</span><span class="token punctuation">,</span> csrf_exempt<span class="token punctuation">(</span>GraphQLView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span>graphiql<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="add-cypress-dependencies" tabindex="-1"><a class="header-anchor" href="#add-cypress-dependencies" aria-hidden="true">#</a> Add Cypress Dependencies</h2><p>Following along with <a href="https://docs.cypress.io/guides/getting-started/installing-cypress#System-requirements" target="_blank" rel="noopener noreferrer">https://docs.cypress.io/guides/getting-started/installing-cypress#System-requirements<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo apt-get install libgtk2.0-0 libgtk-3-0 libgbm-dev libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 libxtst6 xauth xvfb
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Install cypress with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm install cypress --save-dev
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="start-cypress" tabindex="-1"><a class="header-anchor" href="#start-cypress" aria-hidden="true">#</a> Start Cypress</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$(npm bin)/cypress open
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="use-npm-to-open-cypress" tabindex="-1"><a class="header-anchor" href="#use-npm-to-open-cypress" aria-hidden="true">#</a> Use npm to open Cypress</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npx cypress open
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="using-on-wsl-2" tabindex="-1"><a class="header-anchor" href="#using-on-wsl-2" aria-hidden="true">#</a> Using on WSL 2</h2><p>Cypress is not supported on WSL 2 without some workarounds. You can run the following command to run Cypress in headless mode:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>node_modules/.bin/cypress run
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="frontend-clients" tabindex="-1"><a class="header-anchor" href="#frontend-clients" aria-hidden="true">#</a> Frontend clients</h2><h2 id="add-vue-as-standalone-spa-show-how-api-calls-will-not-work-without-cors" tabindex="-1"><a class="header-anchor" href="#add-vue-as-standalone-spa-show-how-api-calls-will-not-work-without-cors" aria-hidden="true">#</a> Add Vue as standalone SPA (show how API calls will not work without CORS)</h2><h2 id="add-cors" tabindex="-1"><a class="header-anchor" href="#add-cors" aria-hidden="true">#</a> Add CORS</h2><h2 id="add-nginx-and-remove-cors" tabindex="-1"><a class="header-anchor" href="#add-nginx-and-remove-cors" aria-hidden="true">#</a> Add NGINX and remove CORS</h2><h2 id="add-nginx-dockerfile-for-local-development" tabindex="-1"><a class="header-anchor" href="#add-nginx-dockerfile-for-local-development" aria-hidden="true">#</a> Add NGINX Dockerfile for local development</h2><h2 id="setup-django-channels-settings-routers-consumers-async-tests" tabindex="-1"><a class="header-anchor" href="#setup-django-channels-settings-routers-consumers-async-tests" aria-hidden="true">#</a> Setup Django Channels (settings, routers, consumers, async tests)</h2><h2 id="setup-git-hooks-in-docker-compose" tabindex="-1"><a class="header-anchor" href="#setup-git-hooks-in-docker-compose" aria-hidden="true">#</a> Setup git hooks in docker-compose</h2><h2 id="setup-vue-in-nginx-web-sockets-for-hot-reloading-index-html-etc" tabindex="-1"><a class="header-anchor" href="#setup-vue-in-nginx-web-sockets-for-hot-reloading-index-html-etc" aria-hidden="true">#</a> Setup Vue in NGINX (web-sockets for hot reloading, index.html, etc)</h2><h2 id="add-session-authentication-for-vue-spa" tabindex="-1"><a class="header-anchor" href="#add-session-authentication-for-vue-spa" aria-hidden="true">#</a> Add Session Authentication for Vue SPA</h2><h2 id="show-how-to-setup-e2e-tests-with-cypress" tabindex="-1"><a class="header-anchor" href="#show-how-to-setup-e2e-tests-with-cypress" aria-hidden="true">#</a> Show how to setup e2e tests with Cypress</h2><h2 id="draw-a-project-diagram-using-diagrams-net" tabindex="-1"><a class="header-anchor" href="#draw-a-project-diagram-using-diagrams-net" aria-hidden="true">#</a> Draw a project diagram using diagrams.net</h2><h2 id="generate-model-visualizations-with-graphviz" tabindex="-1"><a class="header-anchor" href="#generate-model-visualizations-with-graphviz" aria-hidden="true">#</a> Generate model visualizations with graphviz</h2><h2 id="vscode-remote-container" tabindex="-1"><a class="header-anchor" href="#vscode-remote-container" aria-hidden="true">#</a> VSCode remote container</h2><h2 id="add-a-privacy-policy" tabindex="-1"><a class="header-anchor" href="#add-a-privacy-policy" aria-hidden="true">#</a> Add a privacy policy</h2><h2 id="cookie-consent-form" tabindex="-1"><a class="header-anchor" href="#cookie-consent-form" aria-hidden="true">#</a> Cookie consent form</h2><h2 id="add-a-constants-file" tabindex="-1"><a class="header-anchor" href="#add-a-constants-file" aria-hidden="true">#</a> Add a constants file</h2><p>In general it is not idea to have strings with the same value used in multiple parts of your application&#39;s code. One place where we have used the same string values is in multiple places is Bootstrap class names in Django forms.</p><p>We can use a file in our core app called <code>constants.py</code> and import this like:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>from apps.core import constants as c
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Then we can add values to this such as:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>BOOTSTRAP_ALERT_SUCCESS = &quot;alert alert-success&quot;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This will make it easier for us to keep track of things. If we need to change our CSS Framework from Bootstrap to something else, this will be easy to when we are using constants instead of duplicate strings.</p><p>Create a <code>constants.py</code> file:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>touch backend/apps/core/constants.py
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="install-poetry" tabindex="-1"><a class="header-anchor" href="#install-poetry" aria-hidden="true">#</a> Install poetry</h2><p><a href="https://github.com/python-poetry/poetry#installation" target="_blank" rel="noopener noreferrer">https://github.com/python-poetry/poetry#installation<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/install-poetry.py | python -
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Check the version:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>poetry --version
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="run-poetry-init-to-setup-pyproject-toml" tabindex="-1"><a class="header-anchor" href="#run-poetry-init-to-setup-pyproject-toml" aria-hidden="true">#</a> Run <code>poetry init</code> to setup <code>pyproject.toml</code></h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd backend &amp;&amp; poetry init
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ cd backend &amp;&amp; poetry init

This command will guide you through creating your pyproject.toml config.

Package name [backend]:
Version [0.1.0]:
Description []:
Author [Brian Caffey &lt;briancaffey2010@gmail.com&gt;, n to skip]:  n
License []:
Compatible Python versions [^3.8]:

Would you like to define your main dependencies interactively? (yes/no) [yes]
You can specify a package in the following forms:
  - A single name (requests)
  - A name and a constraint (requests@^2.23.0)
  - A git url (git+https://github.com/python-poetry/poetry.git)
  - A git url with a revision (git+https://github.com/python-poetry/poetry.git#develop)
  - A file path (../my-package/my-package.whl)
  - A directory (../my-package/)
  - A url (https://example.com/packages/my-package-0.1.0.tar.gz)

Search for package to add (or leave blank to continue):

Would you like to define your development dependencies interactively? (yes/no) [yes]
Search for package to add (or leave blank to continue):

Generated file

[tool.poetry]
name = &quot;backend&quot;
version = &quot;0.1.0&quot;
description = &quot;&quot;
authors = [&quot;Your Name &lt;you@example.com&gt;&quot;]

[tool.poetry.dependencies]
python = &quot;^3.8&quot;

[tool.poetry.dev-dependencies]

[build-system]
requires = [&quot;poetry-core&gt;=1.0.0&quot;]
build-backend = &quot;poetry.core.masonry.api&quot;


Do you confirm generation? (yes/no) [yes]
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="add-project-dependencies-using-semver-notation" tabindex="-1"><a class="header-anchor" href="#add-project-dependencies-using-semver-notation" aria-hidden="true">#</a> Add project dependencies using SemVer notation</h2><h2 id="add-make-command-to-export-requirements-txt-and-requirements-dev-txt-from-poetry" tabindex="-1"><a class="header-anchor" href="#add-make-command-to-export-requirements-txt-and-requirements-dev-txt-from-poetry" aria-hidden="true">#</a> Add <code>make</code> command to export <code>requirements.txt</code> and <code>requirements_dev.txt</code> from poetry</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>poetry-export:
	cd backend &amp;&amp; poetry export --without-hashes -f requirements.txt -o requirements.txt &amp;&amp; poetry export --without-hashes -f requirements.txt -o requirements_dev.txt --dev
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="add-new-python-dependencies-with-poetry-add" tabindex="-1"><a class="header-anchor" href="#add-new-python-dependencies-with-poetry-add" aria-hidden="true">#</a> Add new python dependencies with <code>poetry add</code></h2><p>For example:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>poetry add requests
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="configure-vscode-to-use-poetry-environment" tabindex="-1"><a class="header-anchor" href="#configure-vscode-to-use-poetry-environment" aria-hidden="true">#</a> Configure VSCode to use Poetry environment</h2><p><a href="https://stackoverflow.com/questions/59882884/vscode-doesnt-show-poetry-virtualenvs-in-select-interpreter-option" target="_blank" rel="noopener noreferrer">StackOverflow Question<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>Answer:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># run these commands from the backend/ directory</span>
<span class="token builtin class-name">cd</span> backend

poetry <span class="token function">env</span> list <span class="token comment"># copy env name</span>
poetry <span class="token function">env</span> remove <span class="token operator">&lt;</span>env name<span class="token operator">&gt;</span>
poetry <span class="token function">install</span>

poetry config virtualenvs.in-project <span class="token boolean">true</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>You can also remove the poetry environment with:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>poetry <span class="token function">env</span> list <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> <span class="token operator">|</span> <span class="token function">xargs</span> poetry <span class="token function">env</span> remove
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="microk8s-setup" tabindex="-1"><a class="header-anchor" href="#microk8s-setup" aria-hidden="true">#</a> microk8s setup</h2><h2 id="install-cdk8s-cli" tabindex="-1"><a class="header-anchor" href="#install-cdk8s-cli" aria-hidden="true">#</a> Install <code>cdk8s-cli</code></h2><p>Install the cdk8s npm package globally:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm i -g cdk8s-cli
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="start-a-cdk8s-project-in-the-k8s-directory" tabindex="-1"><a class="header-anchor" href="#start-a-cdk8s-project-in-the-k8s-directory" aria-hidden="true">#</a> Start a cdk8s project in the k8s directory</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir -p k8s/cdk8s &amp;&amp; cd k8s/cdk8s
cdk8s init typescript-app
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Synthesize the application:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cdk8s synth --app=&#39;./k8s/cdk8s&#39;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/bin/sh: 1: ./k8s/cdk8s: Permission denied
Error: command &quot;./k8s/cdk8s &quot; at /home/brian/gitlab/django-step-by-step returned a non-zero exit code 126
    at ChildProcess.&lt;anonymous&gt; (/home/brian/.nvm/versions/node/v15.3.0/lib/node_modules/cdk8s-cli/lib/util.js:24:27)
    at Object.onceWrapper (node:events:483:26)
    at ChildProcess.emit (node:events:376:20)
    at Process.ChildProcess._handle.onexit (node:internal/child_process:277:12)
make: *** [Makefile:163: cdk8s_synth] Error 1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>To fix the permissions issues, run the following:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo chmod -R +x ./k8s/cdk8s
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="wsl" tabindex="-1"><a class="header-anchor" href="#wsl" aria-hidden="true">#</a> WSL</h2><h2 id="update-kubectl" tabindex="-1"><a class="header-anchor" href="#update-kubectl" aria-hidden="true">#</a> Update kubectl</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>##  Step1: Run the below command to download the latest version of kubectl
curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl

##  Step2: Make kubectl executable
chmod +x kubectl

##  Step3: Move it to the directory where kubectl is already installed
sudo mv kubectl $(which kubectl)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><a href="https://gist.github.com/QaiserAli/18926b5bd9ca7a0551195d449bf31eb6" target="_blank" rel="noopener noreferrer">https://gist.github.com/QaiserAli/18926b5bd9ca7a0551195d449bf31eb6<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="doctl" tabindex="-1"><a class="header-anchor" href="#doctl" aria-hidden="true">#</a> doctl</h2><p><a href="https://github.com/digitalocean/doctl#downloading-a-release-from-github" target="_blank" rel="noopener noreferrer">https://github.com/digitalocean/doctl#downloading-a-release-from-github<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd ~
wget https://github.com/digitalocean/doctl/releases/download/v&lt;version&gt;/doctl-&lt;version&gt;-linux-amd64.tar.gz
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="cdk" tabindex="-1"><a class="header-anchor" href="#cdk" aria-hidden="true">#</a> CDK</h2><h3 id="about-cdk" tabindex="-1"><a class="header-anchor" href="#about-cdk" aria-hidden="true">#</a> About CDK</h3><p>CDK allows you to define AWS infrastructure using high-level programming languages such as TypeScript, Python, Java, etc. You define each part of your application such as VPC, databases, servers, DNS records, IAM roles, etc. These can all be defined using constructs that CDK provides. You can also create your own high-level constructs that use other CDK constructs. This example will use a third-party library that provides a high-level CDK construct for deploying Django applications using Elastic Container Service (ECS). The library is called <a href="https://www.npmjs.com/package/django-cdk" target="_blank" rel="noopener noreferrer">django-cdk<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><h3 id="install-cdk" tabindex="-1"><a class="header-anchor" href="#install-cdk" aria-hidden="true">#</a> Install CDK</h3><p>This section will show how to deploy the application on AWS using Elastic Container Service (ECS) and CDK (Cloud Development Kit). First you will need to install the CDK CLI globally with npm:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm i -g aws-cdk
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Check the version of CDK:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cdk --version
1.109.0 (build c647e38)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="start-the-cdk-project" tabindex="-1"><a class="header-anchor" href="#start-the-cdk-project" aria-hidden="true">#</a> Start the CDK project</h3><p>To start, create a directory called <code>cdk</code> in the root directory and <code>cd</code> into that directory and then initialize a new CDK typescript project. From the root directory of the project, run:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir cdk &amp;&amp; cd cdk &amp;&amp; cdk init app --language typescript
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>You should see the following output:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Applying project template app for typescript
# Welcome to your CDK TypeScript project!

This is a blank project for TypeScript development with CDK.

The `cdk.json` file tells the CDK Toolkit how to execute your app.

## Useful commands

 * `npm run build`   compile typescript to js
 * `npm run watch`   watch for changes and compile
 * `npm run test`    perform the jest unit tests
 * `cdk deploy`      deploy this stack to your default AWS account/region
 * `cdk diff`        compare deployed stack with current state
 * `cdk synth`       emits the synthesized CloudFormation template

Executing npm install...
npm WARN deprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated
npm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated
âœ… All done!
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="install-django-cdk" tabindex="-1"><a class="header-anchor" href="#install-django-cdk" aria-hidden="true">#</a> Install <code>django-cdk</code></h3><p>Now that the CDK project has been initialized, we can install the <a href="https://www.npmjs.com/package/django-cdk" target="_blank" rel="noopener noreferrer"><code>django-cdk</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> package. Add the following to the <code>dependencies</code> section of <code>cdk/package.json</code>:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@aws-cdk/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.109.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;source-map-support&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.5.16&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;django-cdk&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.0.16&quot;</span> <span class="token comment">// add this line</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Now do <code>npm install</code> in the <code>cdk</code> directory:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm install
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>You might need to run <code>npm install --force</code>.</p><p>Next we can import the <code>DjangoEcs</code> construct in our project. In <code>cdk/lib/cdk-stack.ts</code> add the following import:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> DjangoEcs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;django-cdk&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>and then make a new instance of <code>DjangoEcs</code>. <code>cdk-stack.ts</code> should look like this:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> cdk <span class="token keyword">from</span> <span class="token string">&#39;@aws-cdk/core&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DjangoEcs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;django-cdk&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkStack</span> <span class="token keyword">extends</span> <span class="token class-name">cdk</span><span class="token punctuation">.</span>Stack <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>scope<span class="token operator">:</span> cdk<span class="token punctuation">.</span>Construct<span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> props<span class="token operator">?</span><span class="token operator">:</span> cdk<span class="token punctuation">.</span>StackProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> id<span class="token punctuation">,</span> props<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">DjangoEcs</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> <span class="token string">&#39;DjangoEcs&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      imageDirectory<span class="token operator">:</span> <span class="token string">&#39;./backend&#39;</span><span class="token punctuation">,</span>
      webCommand<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;./scripts/start_prod.sh&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      useCeleryBeat<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      domainName<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DOMAIN_NAME</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="npm-run-watch" tabindex="-1"><a class="header-anchor" href="#npm-run-watch" aria-hidden="true">#</a> npm run watch</h3><p>Let&#39;s start the local Typescript server to watch for changes in our CDK app code:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>npm run watch
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="synthesize-the-stack" tabindex="-1"><a class="header-anchor" href="#synthesize-the-stack" aria-hidden="true">#</a> Synthesize the stack</h3><p>CDK is used to generate CloudFormation templates. These are YAML files that are essentially the &quot;bytecode of AWS&quot;. We can see the CloudFormation templates that our CDK app will generate by running:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="add-image-to-blog-post" tabindex="-1"><a class="header-anchor" href="#add-image-to-blog-post" aria-hidden="true">#</a> Add image to blog post</h2><h3 id="install-dependencies" tabindex="-1"><a class="header-anchor" href="#install-dependencies" aria-hidden="true">#</a> Install dependencies</h3><p>This section will describe changes needed to make in order to add an image to the blog post model.</p><p>Add <code>Pillow</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>poetry add Pillow
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>If you are using docker, run <code>make poetry-export</code> and restart docker-compose with:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker-compose down --remove-orphans
docker-compose up --build
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="add-image-field-to-post-model" tabindex="-1"><a class="header-anchor" href="#add-image-field-to-post-model" aria-hidden="true">#</a> Add <code>image</code> field to Post model</h3><p>Add the following field to <code>blog/models.py</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    image <span class="token operator">=</span> models<span class="token punctuation">.</span>ImageField<span class="token punctuation">(</span>upload_to<span class="token operator">=</span><span class="token string">&#39;images&#39;</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="make-and-run-migrations" tabindex="-1"><a class="header-anchor" href="#make-and-run-migrations" aria-hidden="true">#</a> Make and run migrations</h3><p>Once you add this code, run the following management commands:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>python3 manage.py makemigrations
python3 manage.py migrate
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Add the following to the base settings:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>MEDIA_URL <span class="token operator">=</span> <span class="token string">&quot;/media/&quot;</span>
MEDIA_ROOT <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">&quot;media&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="create-backend-media-directory" tabindex="-1"><a class="header-anchor" href="#create-backend-media-directory" aria-hidden="true">#</a> Create backend media directory</h3><p>Next, create the following directory:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mkdir backend/media
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="add-gitignore-to-media-directory" tabindex="-1"><a class="header-anchor" href="#add-gitignore-to-media-directory" aria-hidden="true">#</a> Add .gitignore to media directory</h3><p>Add a file to the <code>media</code> directory called <code>.gitignore</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>*
!.gitignore
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>In the main <code>.gitignore</code> file in the backend directory, we need to make one small change. Comment out the line that contains:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>media
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>This directory is needed for local development, so we will ignore everything inside of this directory, except for the .gitignore file.</p><h3 id="add-url-patterns-for-serving-media-locally" tabindex="-1"><a class="header-anchor" href="#add-url-patterns-for-serving-media-locally" aria-hidden="true">#</a> Add URL patterns for serving media locally</h3><p>In order to view the media files in our application locally, we need to add the following to <code>backend/urls.py</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>if settings.DEBUG:  # pragma: no cover

    # add this part
    urlpatterns += static(
        settings.MEDIA_URL, document_root=settings.MEDIA_ROOT
    )
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>This will allow Django to serve the media files so we can view them in the templates where blog posts are defined.</p><p>Go to the Django admin and add some blog posts with images. You can then click the image link that the Django admin displays to make sure that your application is correctly configured to save and store images.</p><h3 id="add-image-to-django-template" tabindex="-1"><a class="header-anchor" href="#add-image-to-django-template" aria-hidden="true">#</a> Add image to Django template</h3><p>Now that there is an image field on the post model and there is a post with a media file attached, this image should be displayed in both list and detail views.</p><p>Add the following to <code>posts.html</code> and <code>post.html</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>      {% if post.image %}
      &lt;img src={{ post.image.url }} alt=&quot;{{ post.body }}&quot; class=&quot;post-image&quot; /&gt;
      {% endif %}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="add-styling-to-the-image" tabindex="-1"><a class="header-anchor" href="#add-styling-to-the-image" aria-hidden="true">#</a> Add styling to the image</h3><p>In <code>main.css</code>, add the following:</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.post-image</span> <span class="token punctuation">{</span>
    <span class="token property">max-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="add-image-upload-button-for-html-form" tabindex="-1"><a class="header-anchor" href="#add-image-upload-button-for-html-form" aria-hidden="true">#</a> Add image upload button for HTML form</h3><p>First, the <code>&lt;form&gt;</code> element in <code>new_post.html</code> needs to be updated to:</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/posts/new<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="update-postform" tabindex="-1"><a class="header-anchor" href="#update-postform" aria-hidden="true">#</a> Update PostForm</h3><p>Add an <code>image</code> field to the <code>PostForm</code>:</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>forms <span class="token keyword">import</span> <span class="token punctuation">(</span>
    ModelForm<span class="token punctuation">,</span>
    CharField<span class="token punctuation">,</span>
    Textarea<span class="token punctuation">,</span>
    ImageField<span class="token punctuation">,</span> <span class="token comment"># add this line</span>
    FileInput<span class="token punctuation">,</span> <span class="token comment"># add this line</span>
<span class="token punctuation">)</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">PostForm</span><span class="token punctuation">(</span>ModelForm<span class="token punctuation">)</span><span class="token punctuation">:</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment"># add this field</span>
    image <span class="token operator">=</span> ImageField<span class="token punctuation">(</span>
        required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
        widget<span class="token operator">=</span>FileInput<span class="token punctuation">(</span>
            attrs<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token comment"># add the bootstrap class in the form</span>
                <span class="token string">&quot;class&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;form-control&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Post
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;image&quot;</span><span class="token punctuation">]</span> <span class="token comment"># add &quot;image&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="add-image-url-to-postserializer" tabindex="-1"><a class="header-anchor" href="#add-image-url-to-postserializer" aria-hidden="true">#</a> Add image URL to PostSerializer</h3><p>Add <code>&quot;image&quot;,</code> to the end of the <code>fields</code> list under <code>Class Meta:</code>.</p><h3 id="add-images-for-test" tabindex="-1"><a class="header-anchor" href="#add-images-for-test" aria-hidden="true">#</a> Add images for test</h3><p>Add a few images that can be used in local tests</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ls backend/assets/
postgres.png redis.png
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="add-a-field-to-the-post-model-factory" tabindex="-1"><a class="header-anchor" href="#add-a-field-to-the-post-model-factory" aria-hidden="true">#</a> Add a field to the Post Model Factory</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>    image <span class="token operator">=</span> factory<span class="token punctuation">.</span>django<span class="token punctuation">.</span>FileField<span class="token punctuation">(</span>
        from_path<span class="token operator">=</span>Path<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent <span class="token operator">/</span> <span class="token string">&#39;assets/postgres.png&#39;</span>
    <span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="add-cypress-file-upload" tabindex="-1"><a class="header-anchor" href="#add-cypress-file-upload" aria-hidden="true">#</a> Add <code>cypress-file-upload</code></h3><ul><li>Add <code>import &#39;cypress-file-upload&#39;;</code> to <code>cypress/cypress/support/commands.js</code></li><li>Add <code>data-cy</code> to file input</li></ul><p>Follow these steps: <a href="https://www.npmjs.com/package/cypress-file-upload" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/cypress-file-upload<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h3 id="install-graphene-extension-for-image-support-in-graphql" tabindex="-1"><a class="header-anchor" href="#install-graphene-extension-for-image-support-in-graphql" aria-hidden="true">#</a> Install Graphene extension for image support in GraphQL</h3><p>https://github.com/lmcgartland/graphene-file-upload https://pypi.org/project/graphene-file-upload/1.3.0/</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd backend &amp;&amp; poetry add graphene-file-upload
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="add-images-to-test-case-logic" tabindex="-1"><a class="header-anchor" href="#add-images-to-test-case-logic" aria-hidden="true">#</a> Add images to test case logic</h3><p>Optional/Extra steps</p><h2 id="graphql-together-with-or-replacing-drf-rest" tabindex="-1"><a class="header-anchor" href="#graphql-together-with-or-replacing-drf-rest" aria-hidden="true">#</a> GraphQL (together with or replacing DRF/REST)</h2><h2 id="spatial-and-geographic-databases-postgis" tabindex="-1"><a class="header-anchor" href="#spatial-and-geographic-databases-postgis" aria-hidden="true">#</a> Spatial and Geographic Databases (PostGIS)</h2><h2 id="portainer-ui-for-viewing-containers-and-logs" tabindex="-1"><a class="header-anchor" href="#portainer-ui-for-viewing-containers-and-logs" aria-hidden="true">#</a> Portainer UI for viewing containers and logs</h2><h2 id="wagtail-for-managing-blog-content" tabindex="-1"><a class="header-anchor" href="#wagtail-for-managing-blog-content" aria-hidden="true">#</a> Wagtail for managing blog content</h2><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/briancaffey/django-step-by-step/edit/main/vuepress-docs/docs/guide/step-by-step/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">4/24/2025, 1:12:36 PM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/django-step-by-step/topics/vuepress" class="nav-link" aria-label="A guide to this VuePress site"><!--[--><!--]--> A guide to this VuePress site <!--[--><!--]--></a></span><span class="next"><a href="/django-step-by-step/guide/ci-cd/github-actions" class="nav-link" aria-label="GitHub Actions Guide"><!--[--><!--]--> GitHub Actions Guide <!--[--><!--]--></a> â†’ </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/django-step-by-step/assets/js/runtime~app.10395914.js" defer></script><script src="/django-step-by-step/assets/js/981.12928b34.js" defer></script><script src="/django-step-by-step/assets/js/app.9807f846.js" defer></script>
  </body>
</html>
